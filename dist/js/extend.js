/**
 * @modified $Author$
 * @version $Rev$
 */
!function(e){require.config({enable_ozma:true});define("tui/class",[],function(){function t(){return function(){if(this.initialize)this.initialize.apply(this,arguments)}}function n(n,i){var r=this;var a=t();e.extend(a,r,i);var s=Object.create(r.prototype);s.constructor=a;a.prototype=s;e.extend(a.prototype,n);a.superClass=r.prototype;return a}var i=function(i){var r=t();e.extend(r.prototype,i);r.extend=n;return r};i.extend=n;return i});define("tui/event",["tui/class"],function(t){var n=t({initialize:function(){this.__event=window.Zepto?new window.Zepto.Events:e({})}});var i=n.prototype;["bind","one"].forEach(function(t){i[t]=function(n,i,r){if(e.isPlainObject(n))for(var a in n)this[t](a,n[a]);else{var s=this.__event;var o=function(){return i.apply(r||s,arguments.length>0?window.Zepto?arguments:Array.prototype.slice.call(arguments,1):[])};s[t].call(s,n,o);i.guid=o.guid}return this}});["unbind","trigger","triggerHandler"].forEach(function(e){i[e]=function(){var t=this.__event;if(require.debug)console.log("[event] "+this.constructor.__mid+" : "+arguments[0],arguments[1]);var n=t[e].apply(t,arguments);if(require.debug&&n!=t&&void 0!=n)console.log(n);return n}});i.fire=i.trigger;i.firing=i.triggerHandler;n.mix=function(t){return e.extend(t,new n)};return n});define("tui/placeholder",["tui/event"],function(t){var n="placeholder"in document.createElement("input"),i=[],r=t.extend({initialize:function(t,i){var a=this;r.superClass.initialize.apply(a,arguments);t=e(t);a.item=t;var s=a.ph=t.attr("placeholder");if(""==s)return;if(i)a.state2=i;else if(s==t.val()||""==t.val())a.state2=true;else a.state2=false;if(!n&&a.state2){t.val(s);a.trigger("placeholder",[t,a.state2])}a.focus=function(){if(a.state2){!n&&t.val("");a.state2=false;a.trigger("placeholder",[t,a.state2])}};a.blur=function(){var e=t.val();if(""==e)!n&&t.val(s);a.state2=""==e;if(a.state2)a.trigger("placeholder",[t,a.state2])};t.focus(a.focus).bind("blur",a.blur)},state:function(e){var t=this;if(void 0!==e){t.state2=e;if(e)t.restore()}return t.state2},restore:function(){var e=this;if(!e.state2&&!n){e.state2=true;e.item.val(e.ph);e.trigger("placeholder",[e.item,e.state2])}},cancel:function(){var e=this;e.item.unbind("focus",e.focus).unbind("blur",e.blur);var t=i.indexOf(e.item[0]);if(t>-1)i.splice(t,1);return e}});r.NATIVE=n;return r});define("tui/limitTextarea",["tui/event"],function(t){var n=e.browser.msie&&"9.0"==e.browser.version;function i(e){var t=parseInt(e.attr("maxlength")),n=e.val();if(!isNaN(t)&&n.length>t){var i,r,a=document.selection.createRange(),s=document.body.createTextRange();s.moveToElementText(e[0]);r=a.getBookmark();for(i=0;s.compareEndPoints("StartToStart",a)<0&&0!==a.moveStart("character",-1);i++)if("\n"==n.charAt(i))i++;e.val(n.substr(0,Math.min(t,i-1))+n.substr(i,Math.min(t,n.length)));if(n.length!=i){var o=e[0].createTextRange();o.collapse(true);o.moveEnd("character",i-1);o.moveStart("character",i-1);o.select()}}}function r(e,t){var n=t.val();e.trigger("input",[n.length,parseInt(t.attr("maxlength"))])}var a=t.extend({initialize:function(t){var s=this;a.superClass.initialize.apply(s,arguments);if("string"==e.type(t))t=e(t);if(window.addEventListener){t.bind("input",function(){if(n)i(t);r(s,t)});if(n)t.bind("keydown cut paste",function(e){switch(e.type){case"keydown":if(46!=e.keyCode&&8!=e.keyCode)return;default:setTimeout(function(){i(t);r(s,t)},0)}})}else t.bind("propertychange",function(){i(t);r(s,t)})}});return a});define("tui/html5formcore",["tui/event","tui/limitTextarea","tui/placeholder"],function(t,n,i){var r=e.browser.msie&&"9.0"==e.browser.version,a={url:/^\s*[a-zA-z]+:\/\/.*$/,email:/^\s*\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*\s*$/,number:/^\s*-?\.*\d+\s*$/,date:/^\s*\d{2,4}-\d{1,2}-\d{1,2}\s*$/,time:/^\s*\d{1,2}:\d{1,2}(:\d{1,2}(\.\d{1,3})?)?\s*$/,color:/^\s*#?[a-z\d]{3,6}\s*$/},s=document.createElement("input"),o="autofocus"in s,l="form"in s,c=":input:not(:button, :submit, :radio, :checkbox, :reset)",u=t.extend({initialize:function(t,a,s){var l=this;u.superClass.initialize.apply(l,arguments);if("string"==e.type(t))t=e(t);l.form2=t;l.type2=s=s||u.VALID_BLUR;l.list2=[];l.ph2=[];if("function"!=e.type(a)){s=a;a=void 0}if(!t[0]||"FORM"!=t[0].nodeName)return;if(!o)t.find(":input").each(function(){if(null!=this.getAttribute("autofocus")){var t=e(this);t.focus()}});if(!i.NATIVE)t.find("input[placeholder]").each(function(){var t=e(this),n=new i(t);l.list2.push(this);l.ph2.push(n);n.bind("placeholder",function(e,t){l.trigger("placeholder",[e,t])})});l.focusout2=function(){t.attr("novalidate")||l.valid(e(this))};if(s==u.VALID_BLUR)t.delegate(c,"focusout",l.focusout2);var d=[];l.focusin2=function(){var t=e(this);if("TEXTAREA"==this.nodeName&&d.indexOf(this)==-1){new n(t);d.push(this)}l.trigger("focus",[t])};t.delegate(c,"focusin",l.focusin2);l.input2=function(){l.trigger("input",[e(this)])};l.keydown_cut_paste2=function(t){var n=e(this);switch(t.type){case"keydown":if(46!=t.keyCode&&8!=t.keyCode)return;default:setTimeout(function(){l.trigger("input",[n])},0)}};if(window.addEventListener){t.delegate(c,"input",l.input2);if(r)t.delegate("textarea","keydown cut paste",l.keydown_cut_paste2)}else t.delegate(c,"keydown contextmenu",l.input2);t.delegate("input:text[name]","keypress",function(e){if(13==e.keyCode){e.preventDefault();t.submit()}});l.click2=function(e){e.preventDefault();t.submit()};t.delegate("input:submit","click",l.click2);l.submit2=function(e){var n=t.attr("novalidate")||l.validAll();if(n){if(a)return a.call(this,e)}else e.preventDefault()};t.bind("submit",l.submit2)},valid:function(e){var t=this.form2,n=e.val(),i=(e[0].getAttribute("type")||"text").toLowerCase(),r=e.attr("pattern"),s=null!=e[0].getAttribute("required"),o=this.list2.indexOf(e[0]);if(s&&(""==n||o!=-1&&this.ph2[o].state())&&!this.ignore(e)){this.trigger("required",[e]);return false}if(n&&n.length&&"INPUT"==e[0].nodeName&&!this.ignore(e)&&a[i]&&!a[i].test(n)){this.trigger(i,[e]);return false}if(n&&n.length&&"number"==i&&!this.ignore(e)){var l=parseFloat(e.attr("max")),c=parseFloat(e.attr("min")),u=parseFloat(n);if(!isNaN(l)&&u>l){this.trigger("max",[e,l]);return false}if(!isNaN(c)&&u<c){this.trigger("min",[e,c]);return false}}if(r&&r.length&&"text"==i&&n&&!this.ignore(e)){if(o!=-1&&this.ph2[o].state())return true;r=new RegExp(r);if(!r.test(n)){this.trigger("pattern",[e]);return false}}return true},validAll:function(){var e=this,t=true,n=e.form2.find(c);n.each(function(i){t=t&&e.valid(n.eq(i))});return t},ignore:function(t){if("string"==e.type(t))t=e(t);return t.prop("disabled")||null!=t[0].getAttribute("novalidate")},type:function(){return this.type2},placeholder:function(t,n){t=e(t);var i=this.list2.indexOf(t[0]);if(i!=-1)return this.ph2[i];console.error("placeholder not found: "+t[0])},cancel:function(){this.form2.undelegate(c,"focusout",this.focusout2);this.form2.undelegate(c,"focusin",this.focusin2);this.form2.undelegate(c,"input",this.input2);if(r)this.form2.undelegate("textarea","keydown cut paste",this.keydown_cut_paste2);this.form2.undelegate(c,"keydown contextmenu",this.input2);this.form2.undelegate("input:submit","click",this.click2);this.form2.unbind("submit",this.submit2);this.ph2.forEach(function(e){e.cancel()})}});u.VALID_BLUR=1;u.VALID_SUBMIT=2;u.SELECTOR=c;return u});define("tui/template",[],function(t,n){n.ns=function(e,t,n){var i,r=n||window,a=e.split(".").reverse();while((i=a.pop())&&a.length>0){if("undefined"===typeof r[i])r[i]={};else if("object"!==typeof r[i])return false;r=r[i]}if("undefined"!==typeof t)r[i]=t;return r[i]};n.format=function(e,t){return e.replace(/<%\=(\w+)%>/g,function(e,n){return null!=t[n]?t[n]:""})};n.escapeHTML=function(e){e=e||"";var t={"<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","{":"&#123;","}":"&#125;","@":"&#64;"};return e.replace(/[<>'"\{\}@]/g,function(e){return t[e]})};n.substr=function(e,t,n){if(!e||"string"!==typeof e)return"";var i=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return n?n.call(i,i):e.length>i.length?i+"...":i};n.strsize=function(e){return e.replace(/([^\x00-\xff]|[A-Z])/g,"$1 ").length};var i=this.document;n.tplSettings={_cache:{},evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};n.tplHelpers={mix:e.extend,escapeHTML:n.escapeHTML,substr:n.substr,include:r,_has:function(e){return function(t){return n.ns(t,void 0,e)}}};function r(e,t,a){var s,o=n.tplSettings,l=a?"#"+a:"";if(!/[\t\r\n% ]/.test(e)){s=o._cache[e+l];if(!s){var c=i.getElementById(e);if(c)s=o._cache[e+l]=r(c.innerHTML,false,a)}}else{var u="var __p=[];"+(a?"":"with(obj){")+"var mix=api.mix,escapeHTML=api.escapeHTML,substr=api.substr,include=api.include,has=api._has("+(a||"obj")+");"+"__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(o.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(o.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');"+(a?"":"}")+"return __p.join('');";try{s=new Function(a||"obj","api",u)}catch(d){console.log("Could not create a template function: \n"+u)}}return!s?"":t?s(t,n.tplHelpers):s}n.convertTpl=r;n.reloadTpl=function(e){delete n.tplSettings._cache[e]}});define("tui/html5form",["tui/template","tui/html5formcore","tui/placeholder"],function(t,n,i){var r='<div class="g_tip"><h3><%=msg%></h3><% if(info && info.length) { %><p><%=info%></p><% } %><span class="arrow"></span></div>',a={url:"url格式不合法",email:"email格式不合法",number:"请输入一个数字",max:"值必须小于或等于",min:"值必须大于或等于",date:"日期格式不合法",time:"时间格式不合法",color:"颜色格式不合法",required:"请填写此项",pattern:"不符合要求格式"},s=e("body"),o=e(window),l=n.extend({initialize:function(){var t=this;l.superClass.initialize.apply(t,arguments);t.phs3=[],t.msg3=[],t.list3=[],t.action3=[];t.bind("required",function(e){t.tip(e,a["required"])});t.bind("url",function(e){t.tip(e,a["url"])});t.bind("email",function(e){t.tip(e,a["email"])});t.bind("number",function(e){t.tip(e,a["number"])});t.bind("max",function(e,n){t.tip(e,a["max"]+n)});t.bind("min",function(e,n){t.tip(e,a["min"]+n)});t.bind("date",function(e){t.tip(e,a["date"])});t.bind("time",function(e){t.tip(e,a["time"])});t.bind("color",function(e){t.tip(e,a["color"])});t.bind("required",function(e){t.tip(e,a["required"])});t.bind("pattern",function(e){t.tip(e,a["pattern"])});t.bind("placeholder",function(t,n){t=e(t);if(n)t.addClass("g_placeholder");else t.removeClass("g_placeholder")});t.bind("input",function(e){t.clear(e)});if(!i.NATIVE){var n=t.form2.find("input[placeholder]");n.each(function(n,i){var r=t.placeholder(i),a=r.state();if(a)e(i).addClass("g_placeholder")})}},tip:function(n,i){console&&console.warn&&console.warn(n);var a=this;a.clearAll();a.list3.push(n);a.phs3.push(n[0]);n.addClass("g_valid");var l=e(t.convertTpl(r,{msg:i,info:n.attr("title")||""}));l.css({left:n.offset().left,top:n.offset().top+n.outerHeight()+7});l.click(function(){n.focus()});a.msg3.push(l);s.append(l);var c=l.offset().top+l.outerHeight()-o.scrollTop()-o.height();if(c>0)o.scrollTop(o.scrollTop()+c);var u=4,d;a.action3.push(d=setInterval(function(){l.css("left",l.offset().left+u);if(u<0)++u;if(0==u){clearInterval(d);return}u*=-1},50));if(o.scrollTop()>n.offset().top)o.scrollTop(n.offset().top);else if(o.scrollTop()+o.height()<n.offset().top+n.height())o.scrollTop(n.offset().top+n.height()-o.height());if(a.ct)clearTimeout(a.ct);a.ct=setTimeout(function(){a.clearAll()},5e3);return this},clear:function(t){if("string"==e.type(t))t=e(t);var n=this.phs3.indexOf(t[0]);if(n!=-1){this.phs3.splice(n,1);this.list3.splice(n,1);this.msg3[n].remove();this.msg3.splice(n,1);clearInterval(this.action3[n]);this.action3.splice(n,1);t.removeClass("g_valid")}return this},clearAll:function(){this.phs3=[];while(this.msg3.length)this.msg3.pop().remove();while(this.list3.length)this.list3.pop().removeClass("g_valid");while(this.action3.length){var e=this.action3.pop();clearInterval(e)}return this}});return l});define("tui/drag",["tui/event"],function(t){var n=e(window);function i(){if(window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)document.selection.empty();return this}function r(e){e.preventDefault()}var a=t.extend({initialize:function(t,s){var o=this;s=s||{};var l=s.handler||t;a.superClass.initialize.call(o);o.limit=s.limit;o.bubble=s.bubble;o.isCustom=s.isCustom;o.enable2=true;o.state2=false;o.hasMove2=false;o.fx=o.fy=-1;o.x2=o.y2=o.mx2=o.my2=o.px2=o.py2=o.cx2=o.cy2=0;o.node2="string"==e.type(t)?e(t):t;o.container2=s.container||o.node2.parent();o.fixed2="fixed"==o.node2.css("position").toLowerCase();o.handler2="string"==e.type(l)?e(l):l;var c=o.handler2||o.node2;function u(e){e.preventDefault();if(!o.bubble||e.target==c[0]){o.start(e);if(c[0].setCapture)c[0].setCapture()}}c.bind("mousedown",u);function d(t){if(o.state2){o.state2=false;var i=t.pageX-o.mx2+o.x2-o.px2,a=t.pageY-o.my2+o.y2-o.py2;if(o.fixed2){i-=n.scrollLeft();a-=n.scrollTop()}if(o.limit){i=Math.max(i,o.cx2-o.px2);a=Math.max(a,o.cy2-o.py2);i=Math.min(i,o.cWidth-(o.px2-o.cx2)-o.dWidth);a=Math.min(a,o.cHeight-(o.py2-o.cy2)-o.dHeight)}o.x2=o.node2.offset().left;o.y2=o.node2.offset().top;o.trigger("drag:end",[i,a,t.pageX,t.pageY,o.node2,o.container2])}e(document).unbind("selectstart",r);if(c[0].releaseCapture)c[0].releaseCapture()}e(document).bind("mouseup",d);function f(e){if(o.state2&&o.enable2){if(!o.hasMove()&&e.pageX==o.fx&&e.pageY==o.fy);else o.hasMove2=true;var t=e.pageX-o.mx2+o.x2-o.px2,r=e.pageY-o.my2+o.y2-o.py2;if(o.fixed2){t-=n.scrollLeft();r-=n.scrollTop()}if(o.limit){t=Math.max(t,o.cx2-o.px2);r=Math.max(r,o.cy2-o.py2);t=Math.min(t,o.cWidth-(o.px2-o.cx2)-o.dWidth);r=Math.min(r,o.cHeight-(o.py2-o.cy2)-o.dHeight)}if(!o.isCustom)o.node2.css({left:t,top:r});i();o.trigger("drag:move",[t,r,e.pageX,e.pageY,o.node2,o.container2])}}e(document).bind("mousemove",f);o.cancel=function(){c.unbind("mousedown",u);e(document).unbind("mouseup",d);e(document).unbind("mousemove",f)}},start:function(t){var n=this;e(document).bind("selectstart",r);n.offsetParent2=n.node2.offsetParent();if(n.limit){n.cWidth=n.container2.outerWidth();n.cHeight=n.container2.outerHeight();n.pWidth=n.offsetParent2.outerWidth();n.pHeight=n.offsetParent2.outerHeight();n.dWidth=n.node2.outerWidth();n.dHeight=n.node2.outerHeight()}n.fx=t.pageX;n.fy=t.pageY;n.cx2=n.container2.offset().left;n.cy2=n.container2.offset().top;n.px2=n.offsetParent2.offset().left;n.py2=n.offsetParent2.offset().top;n.x2=n.node2.offset().left;n.y2=n.node2.offset().top;n.mx2=t.pageX;n.my2=t.pageY;n.state2=true;n.trigger("drag:start",[n.x2,n.y2,t.pageX,t.pageY,n.node2,n.container2]);return this},enable:function(){this.enable2=true;return this},disable:function(){this.enable2=false;return this},state:function(){return this.state2},hasMove:function(){return this.hasMove2}});return a});define("tui/art",[],function(){var e=window;var t=function(e,n){return t["string"===typeof n?"compile":"render"].apply(t,arguments)};t.version="2.0.2";t.openTag="<%";t.closeTag="%>";t.isEscape=true;t.isCompress=false;t.parser=null;t.render=function(e,n){var i=t.get(e)||r({id:e,name:"Render Error",message:"No Template"});return i(n)};t.compile=function(e,i){var s=arguments;var o=s[2];var l="anonymous";if("string"!==typeof i){o=s[1];i=s[0];e=l}try{var c=a(e,i,o)}catch(u){u.id=e||i;u.name="Syntax Error";return r(u)}function d(n){try{return new c(n,e)+""}catch(a){if(!o)return t.compile(e,i,true)(n);return r(a)()}}d.prototype=c.prototype;d.toString=function(){return c.toString()};if(e!==l)n[e]=d;return d};var n=t.cache={};var i=t.helpers=function(){var e=function(t,n){if("string"!==typeof t){n=typeof t;if("number"===n)t+="";else if("function"===n)t=e(t.call(t));else t=""}return t};var n={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};var i=function(t){return e(t).replace(/&(?![\w#]+;|#\d+)|[<>"']/g,function(e){return n[e]})};var r=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)};var a=function(e,t){if(r(e))for(var n=0,i=e.length;n<i;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)};return{$include:t.render,$string:e,$escape:i,$each:a}}();t.helper=function(e,t){i[e]=t};t.onerror=function(t){var n="Template Error\n\n";for(var i in t)n+="<"+i+">\n"+t[i]+"\n\n";if(e.console)console.error(n)};t.get=function(i){var r;if(n.hasOwnProperty(i))r=n[i];else if("document"in e){var a=document.getElementById(i);if(a){var s=a.value||a.innerHTML;r=t.compile(i,s.replace(/^\s*|\s*$/g,""))}}return r};var r=function(e){t.onerror(e);return function(){return"{Template Error}"}};var a=function(){var e=i.$each;var n="break,case,catch,continue,debugger,default,delete,do,else,false"+",finally,for,function,if,in,instanceof,new,null,return,switch,this"+",throw,true,try,typeof,var,void,while,with"+",abstract,boolean,byte,char,class,const,double,enum,export,extends"+",final,float,goto,implements,import,int,interface,long,native"+",package,private,protected,public,short,static,super,synchronized"+",throws,transient,volatile"+",arguments,let,yield"+",undefined";var r=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var a=/[^\w$]+/g;var s=new RegExp(["\\b"+n.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var o=/^\d[^,]*|,\d[^,]*/g;var l=/^,+|,+$/g;var c=function(e){return e.replace(r,"").replace(a,",").replace(s,"").replace(o,"").replace(l,"").split(/^$|,+/)};return function(n,r,a){var s=t.openTag;var o=t.closeTag;var l=t.parser;var u=r;var d="";var f=1;var p={$data:1,$id:1,$helpers:1,$out:1,$line:1};var v={};var m="var $helpers=this,"+(a?"$line=0,":"");var h="".trim;var g=h?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"];var b=h?"if(content!==undefined){$out+=content;return content;}":"$out.push(content);";var w="function(content){"+b+"}";var y="function(id,data){"+"data=data||$data;"+"var content=$helpers.$include(id,data,$id);"+b+"}";e(u.split(s),function(e,t){e=e.split(o);var n=e[0];var i=e[1];if(1===e.length)d+=k(n);else{d+=T(n);if(i)d+=k(i)}});u=d;if(a)u="try{"+u+"}catch(e){"+"throw {"+"id:$id,"+"name:'Render Error',"+"message:e.message,"+"line:$line,"+"source:"+D(r)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')"+"};"+"}";u=m+g[0]+u+"return new String("+g[3]+");";try{var x=new Function("$data","$id",u);x.prototype=v;return x}catch(_){_.temp="function anonymous($data,$id) {"+u+"}";throw _}function k(e){f+=e.split(/\n/).length-1;if(t.isCompress)e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"");if(e)e=g[1]+D(e)+g[2]+"\n";return e}function T(e){var n=f;if(l)e=l(e);else if(a)e=e.replace(/\n/g,function(){f++;return"$line="+f+";"});if(0===e.indexOf("=")){var r=0!==e.indexOf("==");e=e.replace(/^=*|[\s;]*$/g,"");if(r&&t.isEscape){var s=e.replace(/\s*\([^\)]+\)/,"");if(!i.hasOwnProperty(s)&&!/^(include|print)$/.test(s))e="$escape("+e+")"}else e="$string("+e+")";e=g[1]+e+g[2]}if(a)e="$line="+n+";"+e;$(e);return e+"\n"}function $(t){t=c(t);e(t,function(e){if(!p.hasOwnProperty(e)){M(e);p[e]=true}})}function M(e){var t;if("print"===e)t=w;else if("include"===e){v["$include"]=i["$include"];t=y}else{t="$data."+e;if(i.hasOwnProperty(e)){v[e]=i[e];if(0===e.indexOf("$"))t="$helpers."+e;else t=t+"===undefined?$helpers."+e+":"+t}}m+=e+"="+t+","}function D(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}}}();return t});define("tui/widget",["tui/event","tui/art"],function(t,n){function i(e,t){var n;var i;var r=e.split(" ");if(1==r.length){n=t;i=e}else{n=r.shift();i=r.join(" ")}return[n,i]}var r=t.extend({element:null,template:"<div></div>",eventType:"click",model:{},events:{},targetNode:e(document.body),renderMethod:"append",initialize:function(t){var n=this;t=t||{};r.superClass.initialize.call(n);n.model=e.extend(true,{},n.model);n.events=e.extend(true,{},n.events);e.each(["element","targetNode"],function(){"undefined"!==typeof t[this]&&(n[this]=e(t[this]))});e.each(["template","eventType","renderMethod"],function(){"undefined"!==typeof t[this]&&(n[this]=t[this])});e.each(["model","events"],function(){"undefined"!==typeof t[this]&&e.extend(n[this],t[this])})},find:function(e){return this.element.find(e)},delegate:function(t,n){var r=this;if("string"==e.type(t)&&e.isFunction(n)){var a={};a[t]=n;t=a}e.each(t,function(t,n){var a=function(t){if(e.isFunction(n))return n.call(r,t);else return r[n](t)};var s=i(t,r.eventType);r.element.on(s[0],s[1],a)});return r},undelegate:function(e){var t=this;var n=i(e,t.eventType);t.element.off(n[0],n[1]);return t},render:function(t){var i=this;if(!i.element||!i.element[0])i.element=e(n.compile(i.template)(e.extend({getUrl:this.getUrl||a},t||i.model)));i.delegate(i.events);if(i.renderMethod)i.targetNode[i.renderMethod](i.element);i.trigger("render:success",[]);return i},update:function(t){if(this.renderMethod){this.targetNode[this.renderMethod](n.compile(this.template)(e.extend({getUrl:this.getUrl||a},t)));self.trigger("update:success",[])}}});function a(e){return e}return r});define("tui/mask",[],function(){var t=e('<div class="tui_mask">');var n;var i=e(window);var r=e(document);var a=e(document.body);var s=e.browser.msie&&e.browser.version<7;var o=4096;function l(){var n=Math.max(i.width(),r.width());var a=Math.max(i.height(),r.height());var l="absolute";var c=0;if(e.browser.msie&&a>o){if(!s)l="fixed";else{c=i.scrollTop();if(c+o>a)c=a-o}a=o}t.css({position:l,top:c,width:n,height:a})}return{node:function(){return t},resize:function(){l()},show:function(e){i.bind("resize",l);if(s)i.bind("scroll",l);t.css("z-index",e||9e4);this.resize();if(!n){a.append(t);n=true}else t.show();return this},hide:function(e){i.unbind("resize",l);if(s)i.unbind("scroll",l);if(e){t.remove();n=false}else t.hide();return this},update:function(){l()},state:function(){return t.is(":visible")}}});define("tui/browser",[],function(){var t=navigator.userAgent.toLowerCase();var n={ie6:e.browser.msie&&6==e.browser.version,html5:function(){var e=document.createElement("input");var t=document.createElement("video");return{h264:!!(t.canPlayType&&t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,"")),history:!!(window.history&&window.history.pushState&&window.history.popState),placeholder:"placeholder"in e}},lang:(navigator.language||navigator.systemLanguage).toLowerCase(),iOS:(t.match(/(ipad|iphone|ipod)/)||[])[0],iOSVersion:(t.match(/os\s+([\d_]+)\s+like\s+mac\s+os/)||[0,"0_0_0"])[1].split("_"),wphone:parseFloat((t.match(/windows\sphone\s(?:os\s)?([\d.]+)/)||["","0"])[1]),android:parseFloat((t.match(/android[\s|\/]([\d.]+)/)||["","0"])[1])};n.isMobile=!!n.iOS||!!n.wphone||!!n.android||void 0!==window.orientation||false;n.isPad=n.isMobile&&("ipad"==n.iOS||t.indexOf("mobile")==-1||t.indexOf("windows nt")!=-1&&t.indexOf("touch")!=-1)||false;return n});define("tui/dialog",["tui/browser","tui/art","tui/mask","tui/widget","tui/drag"],function(t,n,i,r,a){var s=e(window);var o=e.browser.msie&&e.browser.version<=7||!e.support.boxModel;var l=10002;var c='<div class="tui_dialog_button"><% for (var i = 0; i < buttons.length; i++) { %>'+'<a data-role="button_<%=i%>" href="#" <%if(buttons[i].className){%>class="<%=buttons[i].className%>"<%}%>><%=buttons[i].name%></a>'+"<% } %></div>";var u='<div class="tui_dialog <%=className%>"><div<% if (hasWrap) { %> class="tui_dialog_wrap"<% } %>><div class="tui_dialog_holder" data-role="holder">'+'<div class="tui_dialog_resize"></div>'+'<div class="tui_dialog_w_tp"></div><div class="tui_dialog_w_bm"></div>'+'<div class="tui_dialog_w_lf"></div><div class="tui_dialog_w_rt"></div>'+'<div class="tui_dialog_w_tl"></div><div class="tui_dialog_w_tr"></div>'+'<div class="tui_dialog_w_bl"></div><div class="tui_dialog_w_br"></div>'+'<div class="tui_dialog_header" data-role="header"><span class="tui_dialog_close" data-role="close" title="关闭">X</span>'+'<div class="tui_dialog_title" data-role="title"><%=title%></div><div class="tui_dialog_bar"><%=bar%></div></div>'+'<div class="tui_dialog_content" data-role="content"></div>'+'<% if (buttons.length > 0) { %><div class="tui_dialog_footer" data-role="footer">'+c+"</div><% } %>"+'<% if (info) { %><div class="tui_dialog_info"><%=info%></div><% } %>'+"</div></div></div>";var d=r.extend({events:{"click [data-role=close]":function(e){e.preventDefault();this.close()}},initialize:function(t){var i=this;var r={template:u,buttons:[],zIndex:l,hasDrag:true,hasMask:true,isFixed:true};t=e.extend(r,t||{});l=t.zIndex;var a=e.browser.msie&&parseFloat(e.browser.version)<9;if("undefined"!=typeof t.hasWrap)a=t.hasWrap;var s={hasWrap:a,className:t.className||"tudou_dialog",title:t.title||"",bar:t.bar||"",info:t.info||"",buttons:t.buttons};t.element=e(n.compile(t.template)(s));d.superClass.initialize.call(this,t);i.dom={holder:i.element.find("[data-role=holder]"),header:i.element.find("[data-role=header]"),title:i.element.find("[data-role=title]"),content:i.element.find("[data-role=content]"),footer:i.element.find("[data-role=footer]"),close:i.element.find("[data-role=close]")};i.config=t;i.open();var o=function(t){if(27==t.keyCode){i.close();e(document).unbind("keydown",o)}};e(document).keydown(o)},title:function(e){this.dom.title.html(e);return this},content:function(e){this.dom.content.html(e);return this},open:function(){var t=this;var n=t.config;var r=t.element;var c=t.dom;r.css("z-index",l);l+=2;if(n.hasMask)i.show(r.css("z-index")-1);r.css("position",o||!n.isFixed?"absolute":"fixed");t.iframeMask=e("<iframe>",{src:"about:blank",frameborder:0,css:{border:"none","z-index":-1,position:"absolute",top:0,left:0,width:"100%",height:"100%"}}).prependTo(c.holder);t.content(n.content||"");e.each(n.buttons,function(e){t.events["[data-role=button_"+e+"]"]=this.callback});if(!t.element.parent()[0])t.render();t.element.show();t.locate();t.resizeLocate=function(e){t.locate()};s.bind("resize",t.resizeLocate);if(o&&n.isFixed){t.iefixScroll=function(e){t.locate()};s.bind("scroll",t.iefixScroll);t.iframeMask.css({height:c.holder.height()})}if(t.config.hasDrag)new a(r,{handler:c.header,limit:true});return t},close:function(e){var t=this;if(t.config.hasMask)i.hide(true);t.trigger("close",[t]);if(!e)t.element.find("iframe").remove();t.element[e?"hide":"remove"]();if(t.resizeLocate)s.unbind("resize",t.resizeLocate);if(t.iefixScroll){s.unbind("scroll",t.iefixScroll);t.iefixScroll=null}return t},locate:function(){var e=this;var t=Math.max(0,s.width()-e.element.width()>>1);if(!e.config.isFixed)var n=s.scrollTop()+(s.height()-e.element.height())/2;else var n=Math.max(0,s.height()-e.element.height()>>1)+(o?s.scrollTop():0);e.element.css({left:t,top:n});return e}});d.confirm=function(t,n){var i={};if(e.isPlainObject(t)){i=t;t=i.msg;n=i.callback}return new d(e.extend({className:"tudou_dialog alert",title:"提示",content:'<div class="tui_dialog_text">'+t+"</div>",hasMask:true,buttons:[{name:"确定",callback:function(e){e.preventDefault();n&&n.call(this);this.close()}},{name:"取消",callback:function(e){e.preventDefault();this.close()}}]},i))};d.alert=function(t,n){var i={};if(e.isPlainObject(t)){i=t;t=i.msg;n=i.callback}return new d(e.extend({className:"tudou_dialog alert",title:"提示",content:'<div class="tui_dialog_text">'+t+"</div>",hasMask:true,buttons:[{name:"确定",callback:function(e){e.preventDefault();n&&n.call(this);this.close()}}]},i))};return d});define("tui/nprogress",[],function(t,n){var i={};var r=e(document.body);i.version="0.1.6";var a=i.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:true,trickleRate:.02,trickleSpeed:800,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};i.configure=function(t){return e.extend(a,t||{})};i.status=null;i.set=function(e){var t=i.isStarted();e=s(e,a.minimum,1);i.status=1===e?null:e;var n=i.render(!t),r=n.find(a.barSelector),o=a.speed,u=a.easing;n[0].offsetWidth;c(function(t){r.css(l(e,o,u));if(1===e){n.css({transition:"none",opacity:1});n[0].offsetWidth;setTimeout(function(){n.css({transition:"all "+o+"ms linear",opacity:0});setTimeout(function(){i.remove();t()},o)},o)}else setTimeout(t,o)});return this};i.isStarted=function(){return"number"===typeof i.status};i.start=function(){if(!i.status)i.set(0);var e=function(){setTimeout(function(){if(!i.status)return;i.trickle();e()},a.trickleSpeed)};if(a.trickle)e();return this};i.done=function(e){if(!e&&!i.status)return this;return i.inc(.3+.5*Math.random()).set(1)};i.inc=function(e){var t=i.status;if(!t)return i.start();else{if("number"!==typeof e)e=(1-t)*s(Math.random()*t,.1,.95);t=s(t+e,0,.994);return i.set(t)}};i.trickle=function(){return i.inc(Math.random()*a.trickleRate)};!function(){var e=0,t=0;i.promise=function(n){if(!n||"resolved"==n.state())return this;if(0==t)i.start();e++;t++;n.always(function(){t--;if(0==t){e=0;i.done()}else i.set((e-t)/e)});return this}}();i.render=function(t){if(""===a.positionUsing)a.positionUsing=i.getPositioningCSS();if("margin"===a.positionUsing)a.showSpinner=false;if(i.isRendered())return e("#nprogress");r.addClass("nprogress-busy");var n=e('<div id="nprogress">'+a.template+"</div>");var s=n.find(a.barSelector),l=t?"-100":o(i.status||0),c=e(a.parent),u;s.css({transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"});if(!a.showSpinner){u=n.find(a.spinnerSelector);u.length&&u.remove()}if(c[0]!=document.body)c.addClass("nprogress-custom-parent");c.append(n);return n};i.remove=function(){r.removeClass("nprogress-busy");e(a.parent).removeClass("nprogress-custom-parent");var t=e("#nprogress");t.length&&t.remove()};i.isRendered=function(){return e("#nprogress").length};i.getPositioningCSS=function(){var e=document.body.style;var t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";if(t+"Perspective"in e)return"translate3d";else if(t+"Transform"in e)return"translate";else return"margin"};function s(e,t,n){if(e<t)return t;if(e>n)return n;return e}function o(e){return 100*(-1+e)}function l(e,t,n){var i;if("translate3d"===a.positionUsing)i={transform:"translate3d("+o(e)+"%,0,0)"};else if("translate"===a.positionUsing)i={transform:"translate("+o(e)+"%,0)"};else i={"margin-left":o(e)+"%"};i.transition="all "+t+"ms "+n;return i}var c=function(){var e=[];function t(){var n=e.shift();if(n)n(t)}return function(n){e.push(n);if(1==e.length)t()}}();return i});define("m/model",["tui/nprogress","tui/dialog","tui/event"],function(t,n,i){function r(n){var i=0;var r=n.success;var a=n.error;delete n.success;delete n.error;n.timeout=1e4;n.nprogress&&t.start();n.success=function(e){if(!e){n.error();return}r.apply(this,Array.prototype.slice.call(arguments));n.nprogress&&t.done()};n.error=function(){i++;if(i<2)e.ajax(n);else{a&&a.apply(this,Array.prototype.slice.call(arguments));n.nprogress&&t.done()}};e.ajax(n)}var a=window.base_domain||"";if("127.0.0.1"===location.host)a="http://www.jishachengta.com.cn";var s=a+"/api/ajax";return{load:r,event:new i,getData:function(e,t,i,a){r({url:s+"?callback=?",data:e,dataType:"jsonp",success:function(e){if(e.errno){console.log(e);i&&i(e);n.alert(e.msg||"")}else t&&t(e)},nprogress:a})},postData:function(t,i,r){return e.post(s,t,function(e){if(e.errno){console.log(e);r&&r(e);n.alert(e.msg||"")}else i&&i(e)},"json")},autoData:function(e,t,n){}}});define("tui/countdown",[],function(){return function(t,n,i){var n=n||3;var r;var t=e(t).html(n);r=setInterval(function(){n--;if(n<=0){clearInterval(r);if(i)i()}t.html(n)},1e3);return{close:function(){clearInterval(r)}}}});define("tui/cookie",[],function(){return function(e,t,n,i){if("string"==typeof e){i=n;n=t;t=e;e=window}if(void 0!==n){i=i||{};var r,a="";if(i.expires){if(i.expires.constructor==Date)r=i.expires;else{r=new Date;r.setTime(r.getTime()+1e3*60*60*24*i.expires)}a="; expires="+r.toGMTString()}var s=i.path?"; path="+i.path:"";var o=i.domain?"; domain="+i.domain:"";var l=i.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(n),a,s,o,l].join("")
}else{n=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)"));return n?decodeURIComponent(n[1]):null}}});define("m/login",["tui/cookie","tui/event","tui/art","tui/dialog","tui/html5form","tui/countdown","m/model"],function(t,n,i,r,a,s,o,l,c){var u="jishachengta.com.cn";var d=window.base_domain||"";var f=new n;var p='欢迎访问集沙成塔 <a href="<%=domain%>/ucenter/" class="uname" target="_blank"><%=u_name%></a><a href="#" class="jsLogout">退出</a>\n|<a href="<%=domain%>/ucenter/order" target="_blank">支持的项目</a>';var v=i.compile(p);var m='<h3>登录</h3>\n<a href="#" class="close" data-role="close">X</a>\n<form id="loginForm">\n<div class="l"><input class="tel" type="text" pattern= "^1[3|5|8|7|4|6]\\d{9}" placeholder="手机号" required /><i class="icon"></i></div>\n<div class="l"><input class="pwd" type="password" pattern="^\\w{6,}" placeholder="密码" required /><i class="icon icon2"></i></div>\n<p class="p"><a href="<%=url%>" target="_blank">忘记密码了？</a></p>\n<div class="btn">\n<a class="submit" href="#">登 录</a>\n</div>\n</form>\n<div class="foot">\n没有账户？<a href="#" target="_blank" class="b goreg">注册账户</a>\n</div>';var h=i.compile(m);var g='<h3>注册新账户</h3>\n<a href="#" class="close" data-role="close">X</a>\n<div class="l l2">已有账户？<a href="#" class="login">登录</a></div>\n<form id="regForm">\n<div class="l"><input class="tel" name="tel" type="text" pattern= "^1[3|5|8|7|4|6]\\d{9}" placeholder="请输入您的手机号(必填)" required /><i class="icon icon3"></i></div>\n<div class="l"><input class="username" name="username" type="text" placeholder="请输入您的真实姓名(必填)" required /><i class="icon"></i></div>\n<div class="l"><input class="pwd" name="pwd" type="password" placeholder="请设置密码，不少于6位(必填)" required /><i class="icon icon2"></i></div>\n<div class="l"><input class="ckpwd" name="checkpwd" type="password" placeholder="请再次输入密码(必填)" /><i class="icon icon2"></i></div>\n<div class="l"><input class="code" name="code" type="text" placeholder="请输入验证码(必填)" required /><a href="#" class="send">获取手机验证码</a></i></div>\n<div class="l"><input class="recmobile" name="recmobile" type="text" placeholder="请输入推荐人的手机号(选填)" /><i class="icon icon3"></i></div>\n<div class="btn">\n<a class="submit" href="#">提交注册</a>\n</div>\n</form>\n<div class="foot">\n注册即代表同意<a href="<%=domain%>/about/service" target="_blank" class="b">集沙成塔服务条款</a>\n</div>';var b=i.compile(g);var w={domain:u,path:"/"};var y=/^1[3|5|8|7|4|6]\d{9}/;t("RELEASE_VERSION","2015_04_99",{domain:u,path:"/",expires:100});var x=t("u_id");var _=t("u_name");var k=t("u_pic");f.isLogin=function(){x=t("u_id");_=t("u_name");k=t("u_pic");return x&&"0"!=x};function T(){}function $(e){e=e||{};k=e.u_pic;x=e.u_id;_=e.u_name;t("u_id",x,w);t("u_name",_,w);t("u_pic",k,w)}function M(){t("u_id",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"});t("u_name",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"});t("u_pic",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"})}function D(t,n){t.domain=d;e("#gUser").html(v(t));n&&$(t)}f.autoLogin=function(e,t){if(f.isLogin())D({u_id:x,u_name:_,u_pic:k})};f.userInfo=function(){return f.isLogin()?{u_id:x,u_name:_,u_pic:k}:false};function L(t,n){var i=new r({className:"login_dialog reg_dialog",content:b({domain:d})});var s=i.dom.content;var l=s.find("form");var c=l.find(".tel");var u=l.find(".pwd");var p=l.find(".ckpwd");var v=l.find(".username");var m=l.find(".code");var h=l.find(".recmobile");var g=new a(l,a.VALID_BLUR);var w={};var x;s.on("click",".submit",function(e){e.preventDefault();w.mobile=c.val().trim();if(!y.test(w.mobile)){g.tip(c,"请填写正确的手机号码");return}if(!x){g.tip(c,"该手机号码已注册");return}w.pwd=u.val().trim();if(!/^\w{6,}$/.test(w.pwd)){g.tip(u,"请输入至少六位数的密码");return}w.ckpwd=p.val().trim();if(w.ckpwd!==w.pwd){g.tip(p,"两次输入的密码不一致");return}w.realname=v.val().trim();if(!w.realname.length){g.tip(v,"请输入真实的姓名");return}w.code=m.val().trim();if(!w.code.length){g.tip(m,"请输入手机验证码");return}w.recmobile=h.val().trim();if(w.recmobile.length&&!y.test(w.recmobile)){g.tip(h,"请填写正确的手机号码");return}w.act=2;o.postData(w,function(e){r.alert("注册成功，请重新登录。");n&&n();i.close();g.clearAll()},T,true)}).on("click",".login",function(e){e.preventDefault();i.close();g.clearAll();f.needLogin()}).on("blur",".ckpwd",function(){var t=e(this).val().trim();var n=u.val().trim();if(t&&t!==n)g.tip(p,"两次输入的密码不一致")}).on("blur",".tel",function(t){t.preventDefault();var n=e(this).val().trim();if(!y.test(n)){g.tip(c,"请填写正确的手机号码");return}if(x)return;o.getData({act:6,mobile:n},function(e){if(1==e.data){g.tip(c,"该手机号码已注册");x=false}else x=true})}).on("change",".tel",function(e){x=false}).on("click",".send",function(t){t.preventDefault();var n=e(this);if(!n.hasClass("sending"))I(n,c,g)})}function I(e,t,n){var i=t.val().trim();if(!y.test(i)){n.tip(t,"请填写正确的手机号码");return}e.html("<i>60</i>秒后可重新获取").addClass("sending");var r=e.find("i");s(r,60,function(){e.html("获取手机验证码").removeClass("sending")});o.getData({act:5,mobile:i},function(e){if(e.data)console.log(e.msg)})}f.needLogin=function(e,t){if("function"===typeof e){t=e;e={}}else e=e||{};if(f.isLogin()){t&&t();return}if(e.reg){L(e,t);return}var n=new r({className:"login_dialog",content:h({url:d+"/findpass/step1"})});var i=n.dom.content;var s=i.find("form");var l=s.find(".tel");var c=s.find(".pwd");var u=new a(s,a.VALID_BLUR);var p={};i.on("click",".submit",function(e){e.preventDefault();p.username=l.val().trim();if(!y.test(p.username)){u.tip(l,"请填写正确的手机号码");return}p.password=c.val().trim();if(!p.password.length){u.tip(c,"请输入密码");return}p.act=3;o.postData(p,function(e){D({u_id:e.data.userId,u_name:e.data.username||e.data.realname,u_pic:"http://u1.tdimg.com/u/U-01.gif"},true);t&&t();n.close();u.clearAll()},T,true)}).on("click",".goreg",function(i){i.preventDefault();n.close();u.clearAll();L(e,t)})};f.exit=function(t){r.confirm("您确认要退出嘛？",function(){var n=/ucenter/.test(location.pathname);o.getData({act:8},function(){e("#gUser").html('欢迎访问集沙成塔<a class="login" href="#" id="gLogin" title="请登录">请登录</a>|<a class="reg" href="#" id="gReg" title="免费注册">免费注册</a>');M();if(n)location.reload();if(t)t()},T,true)})};return f});define("m/mselect",["m/model","tui/art"],function(t,n,i,r){var a='\n<select name="<%=name%>">\n<%data.forEach(function(item){%>\n<option value=<%=item[0]%> <%if(current && current == item[0]){%> selected<%}%> ><%=item[1]%></option>\n<%})%>	\n</select>';var s=n.compile(a);var o={};function l(e,n,i,r,a){e.find('[name="'+i+'"]').remove();if("city"===i)e.find('[name="district"]').remove();t.getData({act:1,parentId:n},function(t){var n=t.data.regionList;if(n&&n.length){e["province"===i?"html":"append"](s({data:n,name:i,current:r}));if(a){if("province"===i&&0!==o.city)l(e,o.province,"city",o.city,true);if("city"===i&&0!==o.district)l(e,o.city,"district",o.district,true)}else if("city"===i)l(e,n[0][0],"district",0,true)}},function(){},true)}r.init=function(t,n){if(!t||!t.length)return;if(n&&n.length){o.province=n[0];o.city=n[1];o.district=n[2];l(t,1,"province",o.province,true)}else l(t,0,"province",0);t.on("change","select",function(){var n=e(this);var i=n.attr("name");switch(i){case"province":l(t,n.val(),"city",0);break;case"city":l(t,n.val(),"district",0)}})}});define("m/address",["tui/html5form","tui/widget","m/model"],function(t,n,i){var r='<div class="new-address">\n<div class="row fix">\n<span class="td">收件人</span> \n<div class="tr">\n<input class="ipt ipt-name" type="text" required placeholder="请填写收件人姓名" <%if(data){%> value="<%=data.name%>" <%}%> />\n</div>\n</div>\n<div class="row fix">\n<span class="td">收件人地址</span>\n<div class="tr"> \n<div class="selects"></div>\n<input class="ipt ipt-address" type="text" required placeholder="请填写详细地址"  <%if(data){%> value="<%=data.address%>" <%}%> />\n</div>\n</div>\n<div class="row fix">\n<span class="td">邮政编码</span> \n<div class="tr">\n<input class="ipt ipt-code" type="text" placeholder="请填写邮政编码"  <%if(data){%> value="<%=data.zipcode%>" <%}%> />\n</div>\n</div>\n<div class="row fix">\n<span class="td">联系电话</span> \n<div class="tr">\n<input class="ipt ipt-tel" type="text" required placeholder="请填写收件人联系电话"  <%if(data){%> value="<%=data.tel%>" <%}%> />\n</div>\n</div>\n<%if(data){%>\n<input type="hidden" value="<%=data.addressId%>" name="addressId" />\n<%}%>\n<div class="row row2">\n<a href="#" class="save" data-role="save">保存</a>\n<a href="#" class="cancel" data-role="close">取消操作</a>\n</div>\n</div>	';var a=n.extend({events:{"click [data-role=save]":function(e){e.preventDefault();this.save()},"click [data-role=close]":function(e){e.preventDefault();this.close()}},template:r,initialize:function(e){a.superClass.initialize.call(this,e)},save:function(n){var r=this;var a=r.element;var s=a.closest("form");var o=new t(s,t.VALID_BLUR);var l=a.find(".ipt-tel");var c=a.find(".ipt-name");var u=a.find(".ipt-address");var d=e("#addressList");var f=a.find(".ipt-code");var p=a.find("[name=addressId]");var v={};v.receiver=c.val();if(v.receiver.length<2){o.tip(c,"请输入收件人姓名");return false}v.address=u.val();if(v.address.length<2){o.tip(u,"请输入收件人地址");return false}v.tel=l.val();if(!/^1[3|5|8|7|4|6][0-9]{9}$/.test(v.tel)){o.tip(l,"请输入有效的电话号码");return false}v.receiver=c.val();v.province=a.find('[name="province"]').val()||"";v.city=a.find('[name="city"]').val()||"";v.district=a.find('[name="district"]').val()||"";v.zipcode=f.val();v.act=4;if(p.length){v.addressId=p.val();v.act=13}i.postData(v,function(e){if(e.data){v.addressId=v.addressId?v.addressId:e.data.addressId;v.tprovince=a.find('[name="province"] option:selected').text();v.tcity=a.find('[name="city"] option:selected').text();v.tdistrict=a.find('[name="district"] option:selected').text();r.trigger("add:success",[v])}else Dialog.alert("添加地址出错")},function(){},true)},del:function(e){var t={};t.addressId=e;t.act=14;i.postData(t,function(e){if(e.data)me.trigger("del:success",[]);else Dialog.alert(e.msg)},function(){},true)},close:function(){this.element.remove();this.element=null;this.trigger("close",[])}});return a});define("tui/util/url",[],function(t,n){function i(t,n){if(!e.browser.msie)if(n)window.open(t,n);else location.href=t;else{var i=e('<a href="'+t+'" target="'+(n||"_self")+'" data-openurl="true"> </a>')[0];document.body.appendChild(i);i.click()}}function r(e){e=e||location.search||location.href;var t={},n=e.match(/[^\s&?#=\/]+=[^\s&?#=]+/g);if(n)for(var i=0,r=n.length;i<r;i++){var a=n[i].split("=");t[a[0]]=decodeURIComponent(a[1])}return t}n.openURL=i;n.params=r});define("tui/util/num",[],function(e,t){function n(e,t){var n="",i=e<0,r=String(Math.abs(e));if(r.length<t)n=new Array(t-r.length+1).join("0");return(i?"-":"")+n+r}function i(e,t){t=t.length;e=e||0;return 1==t?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function r(e,t){t=t||",";return String(e).replace(/(\d)(?=(\d{3})+($|\.))/g,"$1"+t)}function a(e){e=parseInt(e);var t;if(e>=1e8)t=(e/1e8).toFixed(2)+"亿";else if(e>=1e4){var n=e/1e4;var i=parseInt(n).toString();var a=i.length;if(a<4&&n!=i)i=n.toFixed(1==a?2:4-a);t=r(i)+"万"}else t=r(e);return t}function s(e){e=parseInt(e);var t=-1;do{e/=1024;t++}while(e>1024);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}t.pad=n;t.format=i;t.split=r;t.field=a;t.bytes=s});define("module/numstep",["tui/html5form","tui/event"],function(t,n,i,r){var a=n.extend({initialize:function(n){var i=e(n.node).find('[data-role="numstep"]');var r=parseInt(n.step||1,10);var s=this;var o=i.find("input");var l=+o.val();var c=new t(i.closest("form"));a.superClass.initialize.apply(s,arguments);if(i[0])i.on("click",'[data-role="minus"]',function(e){e.preventDefault();if(l-r>0){l-=r;s.trigger("num:step",[l]);o.val(l)}}).on("click",'[data-role="plus"]',function(e){e.preventDefault();l+=r;s.trigger("num:step",[l]);o.val(l)}).on("keyup",o,function(){l=parseInt(o.val(),10);if(!l||"number"!==typeof l||l<1){c&&c.tip(o,"请输入正整数!");return}s.trigger("num:step",[l]);o.val(l)})}});return a});define("m/pay",["tui/html5form","tui/art","module/numstep","tui/util/num","tui/util/url","m/model","tui/dialog","m/address","m/mselect","m/login"],function(t,n,i,r,a,s,o,l,c,u,d,f){function p(){}var v=window.base_domain||"";function m(){var t=e("#cost");var n=0;e("#payItems .total").each(function(t,i){n+=parseInt(e(i).attr("data-total"))});t.text(r.split(n))}f.init=function(){e("#payItems .item").each(function(t,n){var a=e(n);var s=new i({node:n});var o=a.find(".p1").attr("data-price");var l=a.find(".buynum");var c=l.length?l.val():1;var u=a.find(".total");u.text(r.split(c*o)).attr("data-total",c*o);s.bind("num:step",function(e){u.text(r.split(e*o)).attr("data-total",e*o);m()});m()});var t=new l({element:e(".new-address"),targetNode:e(".add-address"),renderMethod:"after"});t.bind("close",function(){e(".add-address").show()});t.bind("add:success",function(n,i){var r=t.element;var a=r.find('[name="province"] option:selected').text()+r.find('[name="city"] option:selected').text()+r.find('[name="district"] option:selected').text()+"&nbsp;"+n.address+"&nbsp;"+n.tel+"&nbsp;"+n.zipcode;e("#addressList").append('<li><label><input name="addressId" type="radio" value="'+i.data.addressId+'" checked /> <span>'+n.receiver+"</span></label>"+a+"</li>");t.close()});e("#address").on("click",".add-address",function(n){n.preventDefault();if(e("#addressList li").length>=10){o.alert("对不起，最多只能添加10个收货地址");return}e(this).hide();t.render({});c.init(e(".selects"))});e("#payItems").on("click",".close",function(t){t.preventDefault();var n=e(this).closest(".item");n.remove();m()});var n=e("#payForm");var d;e("#payForm").on("click",".submit",function(e){e.preventDefault();if(d)return;u.needLogin(function(){var e=n.serialize();d=true;s.postData(e,function(e){if(e.data){o.alert("提交订单成功!");setTimeout(function(){a.openURL(v+"/payinfo/")},1e3)}else o.alert("提交订单出错");d=false},function(){d=false},true)})})}});define("module/tageditor",["tui/widget","tui/art"],function(t,n){var i=8;var r=13;var a=32;var s=188;var o=t.extend({initialize:function(t){var n=this;var t=t||{};t.msgMap=t.msgMap||{};o.superClass.initialize.apply(n,arguments);var l=e(n.targetNode);var c=t.tagNew||e('<span class="tag-new"><input class="tag-input" type="text" autocomplete="off" size="2"></input></span>');var u=c.find("input");n.template=t.template||'<%\nvar op = arguments[0].data;\nvar data = op.data || data;\nif($.type(data)!=\'array\'){\ndata = [data];\n}\nfor(var i = 0; i<data.length; i++){\nvar item = data[i];\nvar enable = op.enable || item.enable;\nvar disable = op.disable || item.disable;\nvar value = item.value || item || \'\';\n%>\n<span class="tag-box <%if(enable){%>tag-enable<%}%> <%if(disable){%>tag-disable<%}%>"><em><%=value%></em><a class="tag-del" href="#">x</a></span>\n<%}%>';n.tagNew=c;n.input=u;n.notify=e(t.notify);n.wordTips=e(t.wordTips);n.max=t.max||9999;n.min=t.min?t.min:0;n.required=t.required;n.distinct=false==t.distinct?false:true;n.maxlength=t.maxlength||9999;if(0==n.min&&n.required)n.min=t.msgMap.min=1;n.msgMap=e.extend({placeholder:"标签用空格或者逗号分隔",required:"至少要添加1个标签",distinct:"标签重复",max:"最多只能添加"+n.max+"个标签",min:"至少要添加"+n.min+"个标签",maxlength:"标签不能超过"+n.maxlength+"个字符"},t.msgMap||{});l.addClass("tag-editor");if(!t.tagNew)l.append(c);l.click(function(){n.input.focus()}).delegate(".tag-del","click",function(t){t.preventDefault();t.stopPropagation();var i=e(this).closest(".tag-box");n.trigger("change:del",[i.find("em").text()]);i.remove()});u.keydown(function(t){var o=e.trim(u.val());var c=n.addValid(o);var d=t.keyCode;if(t.which==i)if(""==u.val()){t.preventDefault();var f=l.children(".tag-box:last");if(f.length){var o=e.trim(f.find("em").text());u.val(o);f.remove()}}if(t.which==s||t.which==a||t.which==r){t.preventDefault();if(!c){if(""!=o){n.addItem(o);u.val("")}}else n.showMsg(c)}if(0==c)n.showMsg(c)})},addItem:function(t,n,i){var r=this;if("function"==e.type(n)){i=n;n=null}r.render(t,n);i&&i();r.trigger("change:add",[t])},addItems:function(t,n,i){var r=this;if("function"==e.type(n)){i=n;n=null}if("array"!=e.type(t))t=[t];e(t).each(function(t,i){var a=i.disable||n;var s=e.trim("string"==e.type(i)?i:i.val);if(""!=s)r.addItem(s,a)});i&&i()},render:function(t,i){var r=this;var a={data:"array"==e.type(t)?t:[t]};if(i)a.disable=true;else a.enable=true;r.tagNew.before(n.compile(r.template)({data:a,$:e}));r.notify.html("")},showMsg:function(e,t){var n=this;var i=n.notify;if(i.length){e=e||"placeholder";var r=n.msgMap[e]||e;var a="placeholder"==e?"tag-notify":"input-notify-error";i.html('<div class="'+a+'">'+r+"</div>");if(t)i.hide()[t]()}},valid:function(){var e=this;var t=0;var n=e.getValue();if(e.required&&0==n.length)t="required";else if(n.length>e.max)t="max";return t},addValid:function(e){var t=this;var n=0;var i=t.getValue();if(i.length>t.max-1)n="max";else if(e.length>t.maxlength)n="maxlength";else if(t.distinct&&i.indexOf(e)!=-1)n="distinct";return n},getValue:function(){var t=this;var n=[];t.targetNode.find(".tag-enable em").each(function(){n.push(e(this).text())});return n}});return o});define("m/p1",["tui/html5form","module/tageditor","tui/dialog"],function(t,n,i,r,a){a.init=function(){var i=new n({targetNode:"#jsTagArea .tag-editor",notify:"#jsTagArea .tag-hit",tagNew:"",maxlength:20,max:5,msgMap:{placeholder:"空格或者逗号可以分隔标签哦，或者直接点击激活灰色标签",required:"至少要添加一个标签哦~",maxlength:"一个标签只能写10个字符啦",max:"就有5个标签的名额哦"}});var r=e('#jsTagArea input[name="tagsarea"]');var a=[];i.bind("change:add",function(e){a.push(e);r.val(a.join("|"))});i.bind("change:del",function(t){var n=e.inArray(t,a);if(n>-1){a.splice(n,1);r.val(a.join("|"))}});e("#jsTagArea").on("click",".tag-list span",function(t){var n=e(this);var r=n.text();var a=i.addValid(r);if(!a)i.addItem(r);else i.showMsg(a)});var s=new n({targetNode:"#jsTagCity .tag-editor",notify:"#jsTagCity .tag-hit",tagNew:"",maxlength:20,max:5,msgMap:{placeholder:"空格或者逗号可以分隔标签哦，或者直接点击激活灰色标签",required:"至少要添加一个标签哦~",maxlength:"一个标签只能写10个字符啦",max:"就有5个标签的名额哦"}});var o=e('#jsTagCity input[name="tagscity"]');var l=[];s.bind("change:add",function(e){l.push(e);o.val(l.join("|"))});s.bind("change:del",function(t){var n=e.inArray(t,l);if(n>-1){l.splice(n,1);o.val(l.join("|"))}});e("#jsTagCity").on("click",".tag-list span",function(t){var n=e(this);if(n.hasClass("more"))u();else c(n.text())});function c(e){var t=s.addValid(e);if(!t)s.addItem(e);else s.showMsg(t)}function u(){}e(".jsTab").on("click",".btn-select",function(t){t.preventDefault();var n=e(this);var i=n.parent().siblings(".row");var r=n.siblings("input");if(n.hasClass("current"))return;i.hide().eq(n.index()).show();n.addClass("current").siblings().removeClass("current");r.val(n.attr("data"))});var d=e("#extendForm");var f=new t(d);var p=d.find(".project");var v=d.find("#myprojects");var m=d.find(".project-list");d.on("click",".submit",function(e){e.preventDefault();var t=d.find(".agree");if("checked"!==t.attr("checked")){f.tip(t,"请阅读此项！");return}d.submit()}).on("keydown",".project",function(t){var n=e(this);if(13==t.keyCode){t.preventDefault();var i=n.val().trim();h(i);return false}}).on("click",".rm",function(t){t.preventDefault();var n=e(this).closest("li");g(n)});function h(t){var n=v.val().trim().split("|");if(t.length&&e.inArray(t,n)<0){n.push(t);v.val(n.join("|"));p.val("");m.append('<li data="'+t+'"><span>'+t+'<i class="rm">x</i></span></li>')}}function g(t){var n=t.attr("data");var i=v.val().trim().split("|");var r=e.inArray(n,i);if(r>-1){i.splice(r,1);v.val(i.join("|"))}t.remove();t=null}}});define("m/nav",["tui/art","m/login"],function(t,n,i,r){n.autoLogin();function a(){e(".mini-nav").on("mouseenter",".btn-qrcode",function(){e(this).find(".qrcode").css({height:"auto"})}).on("mouseleave",".sns",function(){e(this).find(".qrcode").css({height:"0"})})}function s(){e("#gUser").on("click","#gLogin, #gReg",function(t){t.preventDefault();var i=e(this).attr("id");n.needLogin({reg:"gReg"==i})}).on("click",".jsLogout",function(e){e.preventDefault();n.exit()})}r.init=function(){s();a()}});require(["m/nav","m/p1","m/pay","tui/html5form"],function(t,n,i,r){t.init();if(e("#extendForm")[0])n.init();if(e("#payForm")[0])i.init();var a=e("#formStep1");var s=e("#formStep2");var o=e("#formStep3");var l=new r(a,r.VALID_SUBMIT);var c=new r(s,r.VALID_SUBMIT);var u=new r(o,r.VALID_SUBMIT);a.on("click",".submit",function(t){t.preventDefault();if(!e('[name="username"]').val().trim().length){l.tip(e('[name="username"]'),"请输入登录名");return}l.submit()});s.on("click",".submit",function(t){t.preventDefault();if(!e('[name="code"]').val().trim().length){c.tip(e('[name="code"]'),"请输入验证码");return false}c.submit()});o.on("click",".submit",function(t){t.preventDefault();var n=e('[name="pwd"]').val().trim();var i=e('[name="ckpwd"]').val().trim();if(!/^\w{6,}$/.test(n)){u.tip(e('[name="pwd"]'),"请输入至少六位数的密码");return false}if(n!=i){u.tip(e('[name="ckpwd"]'),"两次输入的密码不一致");return false}}).on("blur",'[name="ckpwd"]',function(){var t=e('[name="pwd"]').val().trim();var n=e('[name="ckpwd"]').val().trim();if(t!=n){u.tip(e('[name="ckpwd"]'),"两次输入的密码不一致");return false}})})}(window.jQuery);;