/**
 * @modified $Author$
 * @version $Rev$
 */
!function($){require.config({enable_ozma:true});define("tui/class",[],function(){function e(){return function(){if(this.initialize)this.initialize.apply(this,arguments)}}function t(t,n){var i=this;var r=e();$.extend(r,i,n);var a=Object.create(i.prototype);a.constructor=r;r.prototype=a;$.extend(r.prototype,t);r.superClass=i.prototype;return r}var n=function(n){var i=e();$.extend(i.prototype,n);i.extend=t;return i};n.extend=t;return n});define("tui/event",["tui/class"],function(e){var t=e({initialize:function(){this.__event=window.Zepto?new window.Zepto.Events:$({})}});var n=t.prototype;["bind","one"].forEach(function(e){n[e]=function(t,n,i){if($.isPlainObject(t))for(var r in t)this[e](r,t[r]);else{var a=this.__event;var o=function(){return n.apply(i||a,arguments.length>0?window.Zepto?arguments:Array.prototype.slice.call(arguments,1):[])};a[e].call(a,t,o);n.guid=o.guid}return this}});["unbind","trigger","triggerHandler"].forEach(function(e){n[e]=function(){var t=this.__event;if(require.debug)console.log("[event] "+this.constructor.__mid+" : "+arguments[0],arguments[1]);var n=t[e].apply(t,arguments);if(require.debug&&n!=t&&void 0!=n)console.log(n);return n}});n.fire=n.trigger;n.firing=n.triggerHandler;t.mix=function(e){return $.extend(e,new t)};return t});define("tui/drag",["tui/event"],function(e){var t=$(window);function n(){if(window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)document.selection.empty();return this}function i(e){e.preventDefault()}var r=e.extend({initialize:function(e,a){var o=this;a=a||{};var s=a.handler||e;r.superClass.initialize.call(o);o.limit=a.limit;o.bubble=a.bubble;o.isCustom=a.isCustom;o.enable2=true;o.state2=false;o.hasMove2=false;o.fx=o.fy=-1;o.x2=o.y2=o.mx2=o.my2=o.px2=o.py2=o.cx2=o.cy2=0;o.node2="string"==$.type(e)?$(e):e;o.container2=a.container||o.node2.parent();o.fixed2="fixed"==o.node2.css("position").toLowerCase();o.handler2="string"==$.type(s)?$(s):s;var l=o.handler2||o.node2;function u(e){e.preventDefault();if(!o.bubble||e.target==l[0]){o.start(e);if(l[0].setCapture)l[0].setCapture()}}l.bind("mousedown",u);function c(e){if(o.state2){o.state2=false;var n=e.pageX-o.mx2+o.x2-o.px2,r=e.pageY-o.my2+o.y2-o.py2;if(o.fixed2){n-=t.scrollLeft();r-=t.scrollTop()}if(o.limit){n=Math.max(n,o.cx2-o.px2);r=Math.max(r,o.cy2-o.py2);n=Math.min(n,o.cWidth-(o.px2-o.cx2)-o.dWidth);r=Math.min(r,o.cHeight-(o.py2-o.cy2)-o.dHeight)}o.x2=o.node2.offset().left;o.y2=o.node2.offset().top;o.trigger("drag:end",[n,r,e.pageX,e.pageY,o.node2,o.container2])}$(document).unbind("selectstart",i);if(l[0].releaseCapture)l[0].releaseCapture()}$(document).bind("mouseup",c);function d(e){if(o.state2&&o.enable2){if(!o.hasMove()&&e.pageX==o.fx&&e.pageY==o.fy);else o.hasMove2=true;var i=e.pageX-o.mx2+o.x2-o.px2,r=e.pageY-o.my2+o.y2-o.py2;if(o.fixed2){i-=t.scrollLeft();r-=t.scrollTop()}if(o.limit){i=Math.max(i,o.cx2-o.px2);r=Math.max(r,o.cy2-o.py2);i=Math.min(i,o.cWidth-(o.px2-o.cx2)-o.dWidth);r=Math.min(r,o.cHeight-(o.py2-o.cy2)-o.dHeight)}if(!o.isCustom)o.node2.css({left:i,top:r});n();o.trigger("drag:move",[i,r,e.pageX,e.pageY,o.node2,o.container2])}}$(document).bind("mousemove",d);o.cancel=function(){l.unbind("mousedown",u);$(document).unbind("mouseup",c);$(document).unbind("mousemove",d)}},start:function(e){var t=this;$(document).bind("selectstart",i);t.offsetParent2=t.node2.offsetParent();if(t.limit){t.cWidth=t.container2.outerWidth();t.cHeight=t.container2.outerHeight();t.pWidth=t.offsetParent2.outerWidth();t.pHeight=t.offsetParent2.outerHeight();t.dWidth=t.node2.outerWidth();t.dHeight=t.node2.outerHeight()}t.fx=e.pageX;t.fy=e.pageY;t.cx2=t.container2.offset().left;t.cy2=t.container2.offset().top;t.px2=t.offsetParent2.offset().left;t.py2=t.offsetParent2.offset().top;t.x2=t.node2.offset().left;t.y2=t.node2.offset().top;t.mx2=e.pageX;t.my2=e.pageY;t.state2=true;t.trigger("drag:start",[t.x2,t.y2,e.pageX,e.pageY,t.node2,t.container2]);return this},enable:function(){this.enable2=true;return this},disable:function(){this.enable2=false;return this},state:function(){return this.state2},hasMove:function(){return this.hasMove2}});return r});define("tui/art",[],function(){var e=window;var t=function(e,n){return t["string"===typeof n?"compile":"render"].apply(t,arguments)};t.version="2.0.2";t.openTag="<%";t.closeTag="%>";t.isEscape=true;t.isCompress=false;t.parser=null;t.render=function(e,n){var i=t.get(e)||r({id:e,name:"Render Error",message:"No Template"});return i(n)};t.compile=function(e,i){var o=arguments;var s=o[2];var l="anonymous";if("string"!==typeof i){s=o[1];i=o[0];e=l}try{var u=a(e,i,s)}catch(c){c.id=e||i;c.name="Syntax Error";return r(c)}function d(n){try{return new u(n,e)+""}catch(a){if(!s)return t.compile(e,i,true)(n);return r(a)()}}d.prototype=u.prototype;d.toString=function(){return u.toString()};if(e!==l)n[e]=d;return d};var n=t.cache={};var i=t.helpers=function(){var e=function(t,n){if("string"!==typeof t){n=typeof t;if("number"===n)t+="";else if("function"===n)t=e(t.call(t));else t=""}return t};var n={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};var i=function(t){return e(t).replace(/&(?![\w#]+;|#\d+)|[<>"']/g,function(e){return n[e]})};var r=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)};var a=function(e,t){if(r(e))for(var n=0,i=e.length;n<i;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)};return{$include:t.render,$string:e,$escape:i,$each:a}}();t.helper=function(e,t){i[e]=t};t.onerror=function(t){var n="Template Error\n\n";for(var i in t)n+="<"+i+">\n"+t[i]+"\n\n";if(e.console)console.error(n)};t.get=function(i){var r;if(n.hasOwnProperty(i))r=n[i];else if("document"in e){var a=document.getElementById(i);if(a){var o=a.value||a.innerHTML;r=t.compile(i,o.replace(/^\s*|\s*$/g,""))}}return r};var r=function(e){t.onerror(e);return function(){return"{Template Error}"}};var a=function(){var e=i.$each;var n="break,case,catch,continue,debugger,default,delete,do,else,false"+",finally,for,function,if,in,instanceof,new,null,return,switch,this"+",throw,true,try,typeof,var,void,while,with"+",abstract,boolean,byte,char,class,const,double,enum,export,extends"+",final,float,goto,implements,import,int,interface,long,native"+",package,private,protected,public,short,static,super,synchronized"+",throws,transient,volatile"+",arguments,let,yield"+",undefined";var r=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var a=/[^\w$]+/g;var o=new RegExp(["\\b"+n.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var s=/^\d[^,]*|,\d[^,]*/g;var l=/^,+|,+$/g;var u=function(e){return e.replace(r,"").replace(a,",").replace(o,"").replace(s,"").replace(l,"").split(/^$|,+/)};return function(n,r,a){var o=t.openTag;var s=t.closeTag;var l=t.parser;var c=r;var d="";var f=1;var p={$data:1,$id:1,$helpers:1,$out:1,$line:1};var v={};var h="var $helpers=this,"+(a?"$line=0,":"");var m="".trim;var g=m?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"];var b=m?"if(content!==undefined){$out+=content;return content;}":"$out.push(content);";var w="function(content){"+b+"}";var y="function(id,data){"+"data=data||$data;"+"var content=$helpers.$include(id,data,$id);"+b+"}";e(c.split(o),function(e,t){e=e.split(s);var n=e[0];var i=e[1];if(1===e.length)d+=k(n);else{d+=$(n);if(i)d+=k(i)}});c=d;if(a)c="try{"+c+"}catch(e){"+"throw {"+"id:$id,"+"name:'Render Error',"+"message:e.message,"+"line:$line,"+"source:"+C(r)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')"+"};"+"}";c=h+g[0]+c+"return new String("+g[3]+");";try{var x=new Function("$data","$id",c);x.prototype=v;return x}catch(_){_.temp="function anonymous($data,$id) {"+c+"}";throw _}function k(e){f+=e.split(/\n/).length-1;if(t.isCompress)e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"");if(e)e=g[1]+C(e)+g[2]+"\n";return e}function $(e){var n=f;if(l)e=l(e);else if(a)e=e.replace(/\n/g,function(){f++;return"$line="+f+";"});if(0===e.indexOf("=")){var r=0!==e.indexOf("==");e=e.replace(/^=*|[\s;]*$/g,"");if(r&&t.isEscape){var o=e.replace(/\s*\([^\)]+\)/,"");if(!i.hasOwnProperty(o)&&!/^(include|print)$/.test(o))e="$escape("+e+")"}else e="$string("+e+")";e=g[1]+e+g[2]}if(a)e="$line="+n+";"+e;T(e);return e+"\n"}function T(t){t=u(t);e(t,function(e){if(!p.hasOwnProperty(e)){M(e);p[e]=true}})}function M(e){var t;if("print"===e)t=w;else if("include"===e){v["$include"]=i["$include"];t=y}else{t="$data."+e;if(i.hasOwnProperty(e)){v[e]=i[e];if(0===e.indexOf("$"))t="$helpers."+e;else t=t+"===undefined?$helpers."+e+":"+t}}h+=e+"="+t+","}function C(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}}}();return t});define("tui/widget",["tui/event","tui/art"],function(e,t){function n(e,t){var n;var i;var r=e.split(" ");if(1==r.length){n=t;i=e}else{n=r.shift();i=r.join(" ")}return[n,i]}var i=e.extend({element:null,template:"<div></div>",eventType:"click",model:{},events:{},targetNode:$(document.body),renderMethod:"append",initialize:function(e){var t=this;e=e||{};i.superClass.initialize.call(t);t.model=$.extend(true,{},t.model);t.events=$.extend(true,{},t.events);$.each(["element","targetNode"],function(){"undefined"!==typeof e[this]&&(t[this]=$(e[this]))});$.each(["template","eventType","renderMethod"],function(){"undefined"!==typeof e[this]&&(t[this]=e[this])});$.each(["model","events"],function(){"undefined"!==typeof e[this]&&$.extend(t[this],e[this])})},find:function(e){return this.element.find(e)},delegate:function(e,t){var i=this;if("string"==$.type(e)&&$.isFunction(t)){var r={};r[e]=t;e=r}$.each(e,function(e,t){var r=function(e){if($.isFunction(t))return t.call(i,e);else return i[t](e)};var a=n(e,i.eventType);i.element.on(a[0],a[1],r)});return i},undelegate:function(e){var t=this;var i=n(e,t.eventType);t.element.off(i[0],i[1]);return t},render:function(e){var n=this;if(!n.element||!n.element[0])n.element=$(t.compile(n.template)($.extend({getUrl:this.getUrl||r},e||n.model)));n.delegate(n.events);if(n.renderMethod)n.targetNode[n.renderMethod](n.element);n.trigger("render:success",[]);return n},update:function(e){if(this.renderMethod){this.targetNode[this.renderMethod](t.compile(this.template)($.extend({getUrl:this.getUrl||r},e)));self.trigger("update:success",[])}}});function r(e){return e}return i});define("tui/mask",[],function(){var e=$('<div class="tui_mask">');var t;var n=$(window);var i=$(document);var r=$(document.body);var a=$.browser.msie&&$.browser.version<7;var o=4096;function s(){var t=Math.max(n.width(),i.width());var r=Math.max(n.height(),i.height());var s="absolute";var l=0;if($.browser.msie&&r>o){if(!a)s="fixed";else{l=n.scrollTop();if(l+o>r)l=r-o}r=o}e.css({position:s,top:l,width:t,height:r})}return{node:function(){return e},resize:function(){s()},show:function(i){n.bind("resize",s);if(a)n.bind("scroll",s);e.css("z-index",i||9e4);this.resize();if(!t){r.append(e);t=true}else e.show();return this},hide:function(i){n.unbind("resize",s);if(a)n.unbind("scroll",s);if(i){e.remove();t=false}else e.hide();return this},update:function(){s()},state:function(){return e.is(":visible")}}});define("tui/browser",[],function(){var e=navigator.userAgent.toLowerCase();var t={ie6:$.browser.msie&&6==$.browser.version,html5:function(){var e=document.createElement("input");var t=document.createElement("video");return{h264:!!(t.canPlayType&&t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,"")),history:!!(window.history&&window.history.pushState&&window.history.popState),placeholder:"placeholder"in e}},lang:(navigator.language||navigator.systemLanguage).toLowerCase(),iOS:(e.match(/(ipad|iphone|ipod)/)||[])[0],iOSVersion:(e.match(/os\s+([\d_]+)\s+like\s+mac\s+os/)||[0,"0_0_0"])[1].split("_"),wphone:parseFloat((e.match(/windows\sphone\s(?:os\s)?([\d.]+)/)||["","0"])[1]),android:parseFloat((e.match(/android[\s|\/]([\d.]+)/)||["","0"])[1])};t.isMobile=!!t.iOS||!!t.wphone||!!t.android||void 0!==window.orientation||false;t.isPad=t.isMobile&&("ipad"==t.iOS||e.indexOf("mobile")==-1||e.indexOf("windows nt")!=-1&&e.indexOf("touch")!=-1)||false;return t});define("tui/dialog",["tui/browser","tui/art","tui/mask","tui/widget","tui/drag"],function(e,t,n,i,r){var a=$(window);var o=$.browser.msie&&$.browser.version<=7||!$.support.boxModel;var s=10002;var l='<div class="tui_dialog_button"><% for (var i = 0; i < buttons.length; i++) { %>'+'<a data-role="button_<%=i%>" href="#" <%if(buttons[i].className){%>class="<%=buttons[i].className%>"<%}%>><%=buttons[i].name%></a>'+"<% } %></div>";var u='<div class="tui_dialog <%=className%>"><div<% if (hasWrap) { %> class="tui_dialog_wrap"<% } %>><div class="tui_dialog_holder" data-role="holder">'+'<div class="tui_dialog_resize"></div>'+'<div class="tui_dialog_w_tp"></div><div class="tui_dialog_w_bm"></div>'+'<div class="tui_dialog_w_lf"></div><div class="tui_dialog_w_rt"></div>'+'<div class="tui_dialog_w_tl"></div><div class="tui_dialog_w_tr"></div>'+'<div class="tui_dialog_w_bl"></div><div class="tui_dialog_w_br"></div>'+'<div class="tui_dialog_header" data-role="header"><span class="tui_dialog_close" data-role="close" title="关闭">X</span>'+'<div class="tui_dialog_title" data-role="title"><%=title%></div><div class="tui_dialog_bar"><%=bar%></div></div>'+'<div class="tui_dialog_content" data-role="content"></div>'+'<% if (buttons.length > 0) { %><div class="tui_dialog_footer" data-role="footer">'+l+"</div><% } %>"+'<% if (info) { %><div class="tui_dialog_info"><%=info%></div><% } %>'+"</div></div></div>";var c=i.extend({events:{"click [data-role=close]":function(e){e.preventDefault();this.close()}},initialize:function(e){var n=this;var i={template:u,buttons:[],zIndex:s,hasDrag:true,hasMask:true,isFixed:true};e=$.extend(i,e||{});s=e.zIndex;var r=$.browser.msie&&parseFloat($.browser.version)<9;if("undefined"!=typeof e.hasWrap)r=e.hasWrap;var a={hasWrap:r,className:e.className||"tudou_dialog",title:e.title||"",bar:e.bar||"",info:e.info||"",buttons:e.buttons};e.element=$(t.compile(e.template)(a));c.superClass.initialize.call(this,e);n.dom={holder:n.element.find("[data-role=holder]"),header:n.element.find("[data-role=header]"),title:n.element.find("[data-role=title]"),content:n.element.find("[data-role=content]"),footer:n.element.find("[data-role=footer]"),close:n.element.find("[data-role=close]")};n.config=e;n.open();var o=function(e){if(27==e.keyCode){n.close();$(document).unbind("keydown",o)}};$(document).keydown(o)},title:function(e){this.dom.title.html(e);return this},content:function(e){this.dom.content.html(e);return this},open:function(){var e=this;var t=e.config;var i=e.element;var l=e.dom;i.css("z-index",s);s+=2;if(t.hasMask)n.show(i.css("z-index")-1);i.css("position",o||!t.isFixed?"absolute":"fixed");e.iframeMask=$("<iframe>",{src:"about:blank",frameborder:0,css:{border:"none","z-index":-1,position:"absolute",top:0,left:0,width:"100%",height:"100%"}}).prependTo(l.holder);e.content(t.content||"");$.each(t.buttons,function(t){e.events["[data-role=button_"+t+"]"]=this.callback});if(!e.element.parent()[0])e.render();e.element.show();e.locate();e.resizeLocate=function(t){e.locate()};a.bind("resize",e.resizeLocate);if(o&&t.isFixed){e.iefixScroll=function(t){e.locate()};a.bind("scroll",e.iefixScroll);e.iframeMask.css({height:l.holder.height()})}if(e.config.hasDrag)new r(i,{handler:l.header,limit:true});return e},close:function(e){var t=this;if(t.config.hasMask)n.hide(true);t.trigger("close",[t]);if(!e)t.element.find("iframe").remove();t.element[e?"hide":"remove"]();if(t.resizeLocate)a.unbind("resize",t.resizeLocate);if(t.iefixScroll){a.unbind("scroll",t.iefixScroll);t.iefixScroll=null}return t},locate:function(){var e=this;var t=Math.max(0,a.width()-e.element.width()>>1);if(!e.config.isFixed)var n=a.scrollTop()+(a.height()-e.element.height())/2;else var n=Math.max(0,a.height()-e.element.height()>>1)+(o?a.scrollTop():0);e.element.css({left:t,top:n});return e}});c.confirm=function(e,t){var n={};if($.isPlainObject(e)){n=e;e=n.msg;t=n.callback}return new c($.extend({className:"tudou_dialog alert",title:"提示",content:'<div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"确定",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}},{name:"取消",callback:function(e){e.preventDefault();this.close()}}]},n))};c.alert=function(e,t){var n={};if($.isPlainObject(e)){n=e;e=n.msg;t=n.callback}return new c($.extend({className:"tudou_dialog alert",title:"提示",content:'<div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"确定",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}}]},n))};return c});define("tui/nprogress",[],function(e,t){var n={};var i=$(document.body);n.version="0.1.6";var r=n.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:true,trickleRate:.02,trickleSpeed:800,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};n.configure=function(e){return $.extend(r,e||{})};n.status=null;n.set=function(e){var t=n.isStarted();e=a(e,r.minimum,1);n.status=1===e?null:e;var i=n.render(!t),o=i.find(r.barSelector),u=r.speed,c=r.easing;i[0].offsetWidth;l(function(t){o.css(s(e,u,c));if(1===e){i.css({transition:"none",opacity:1});i[0].offsetWidth;setTimeout(function(){i.css({transition:"all "+u+"ms linear",opacity:0});setTimeout(function(){n.remove();t()},u)},u)}else setTimeout(t,u)});return this};n.isStarted=function(){return"number"===typeof n.status};n.start=function(){if(!n.status)n.set(0);var e=function(){setTimeout(function(){if(!n.status)return;n.trickle();e()},r.trickleSpeed)};if(r.trickle)e();return this};n.done=function(e){if(!e&&!n.status)return this;return n.inc(.3+.5*Math.random()).set(1)};n.inc=function(e){var t=n.status;if(!t)return n.start();else{if("number"!==typeof e)e=(1-t)*a(Math.random()*t,.1,.95);t=a(t+e,0,.994);return n.set(t)}};n.trickle=function(){return n.inc(Math.random()*r.trickleRate)};!function(){var e=0,t=0;n.promise=function(i){if(!i||"resolved"==i.state())return this;if(0==t)n.start();e++;t++;i.always(function(){t--;if(0==t){e=0;n.done()}else n.set((e-t)/e)});return this}}();n.render=function(e){if(""===r.positionUsing)r.positionUsing=n.getPositioningCSS();if("margin"===r.positionUsing)r.showSpinner=false;if(n.isRendered())return $("#nprogress");i.addClass("nprogress-busy");var t=$('<div id="nprogress">'+r.template+"</div>");var a=t.find(r.barSelector),s=e?"-100":o(n.status||0),l=$(r.parent),u;a.css({transition:"all 0 linear",transform:"translate3d("+s+"%,0,0)"});if(!r.showSpinner){u=t.find(r.spinnerSelector);u.length&&u.remove()}if(l[0]!=document.body)l.addClass("nprogress-custom-parent");l.append(t);return t};n.remove=function(){i.removeClass("nprogress-busy");$(r.parent).removeClass("nprogress-custom-parent");var e=$("#nprogress");e.length&&e.remove()};n.isRendered=function(){return $("#nprogress").length};n.getPositioningCSS=function(){var e=document.body.style;var t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";if(t+"Perspective"in e)return"translate3d";else if(t+"Transform"in e)return"translate";else return"margin"};function a(e,t,n){if(e<t)return t;if(e>n)return n;return e}function o(e){return 100*(-1+e)}function s(e,t,n){var i;if("translate3d"===r.positionUsing)i={transform:"translate3d("+o(e)+"%,0,0)"};else if("translate"===r.positionUsing)i={transform:"translate("+o(e)+"%,0)"};else i={"margin-left":o(e)+"%"};i.transition="all "+t+"ms "+n;return i}var l=function(){var e=[];function t(){var n=e.shift();if(n)n(t)}return function(n){e.push(n);if(1==e.length)t()}}();return n});define("m/model",["tui/nprogress","tui/dialog","tui/event"],function(e,t,n){function i(t){var n=0;var i=t.success;var r=t.error;delete t.success;delete t.error;t.timeout=1e4;t.nprogress&&e.start();t.success=function(n){if(!n){t.error();return}i.apply(this,Array.prototype.slice.call(arguments));t.nprogress&&e.done()};t.error=function(){n++;if(n<2)$.ajax(t);else{r&&r.apply(this,Array.prototype.slice.call(arguments));t.nprogress&&e.done()}};$.ajax(t)}var r=window.base_domain||"";if("127.0.0.1"===location.host)r="http://www.jishachengta.com.cn";var a=r+"/api/ajax";return{load:i,event:new n,getData:function(e,n,r,o){i({url:a+"?callback=?",data:e,dataType:"jsonp",success:function(e){if(e.errno){console.log(e);r&&r(e);t.alert(e.msg||"")}else n&&n(e)},nprogress:o})},postData:function(e,n,i){return $.post(a,e,function(e){if(e.errno){console.log(e);i&&i(e);t.alert(e.msg||"")}else n&&n(e)},"json")},autoData:function(e,t,n){}}});define("m/favor",["m/model","tui/event","tui/dialog"],function(e,t,n){var i=new t;i.init=function(e){e=$(e);e.find('[data-role="favor"]').each(function(e,t){var n=$(this);var i=n.attr("data-id");s(n,i)});e.on("click",'[data-role="favor"]',function(e){e.preventDefault();var t=$(this);t.hasClass("favored")?o(t):a(t)})};function r(e,t,n){var i=e.find(".f1");var r=e.find(".f2");var a=parseInt(i.text().trim(),10);if(t){i.text(n?a:a+1);r.text("取消关注");e.addClass("favored")}else{i.text(a-1);r.text("关注");e.removeClass("favored")}}function a(t){var n={};n.productId=t.attr("data-id");n.act=12;e.getData(n,function(){r(t,true)})}function o(e){r(e,false)}function s(e,t){}return i});define("m/share",[],function(){return function(){window._bd_share_config={common:{bdSnsKey:{},bdText:"",bdMini:"2",bdPic:"",bdStyle:"0",bdSize:"16"},share:{},image:false,selectShare:false};with(document)0[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)]}});define("tui/countdown",[],function(){return function(e,t,n){var t=t||3;var i;var e=$(e).html(t);i=setInterval(function(){t--;if(t<=0){clearInterval(i);if(n)n()}e.html(t)},1e3);return{close:function(){clearInterval(i)}}}});define("tui/placeholder",["tui/event"],function(e){var t="placeholder"in document.createElement("input"),n=[],i=e.extend({initialize:function(e,n){var r=this;i.superClass.initialize.apply(r,arguments);e=$(e);r.item=e;var a=r.ph=e.attr("placeholder");if(""==a)return;if(n)r.state2=n;else if(a==e.val()||""==e.val())r.state2=true;else r.state2=false;if(!t&&r.state2){e.val(a);r.trigger("placeholder",[e,r.state2])}r.focus=function(){if(r.state2){!t&&e.val("");r.state2=false;r.trigger("placeholder",[e,r.state2])}};r.blur=function(){var n=e.val();if(""==n)!t&&e.val(a);r.state2=""==n;if(r.state2)r.trigger("placeholder",[e,r.state2])};e.focus(r.focus).bind("blur",r.blur)},state:function(e){var t=this;if(void 0!==e){t.state2=e;if(e)t.restore()}return t.state2},restore:function(){var e=this;if(!e.state2&&!t){e.state2=true;e.item.val(e.ph);e.trigger("placeholder",[e.item,e.state2])}},cancel:function(){var e=this;e.item.unbind("focus",e.focus).unbind("blur",e.blur);var t=n.indexOf(e.item[0]);if(t>-1)n.splice(t,1);return e}});i.NATIVE=t;return i});define("tui/limitTextarea",["tui/event"],function(e){var t=$.browser.msie&&"9.0"==$.browser.version;function n(e){var t=parseInt(e.attr("maxlength")),n=e.val();if(!isNaN(t)&&n.length>t){var i,r,a=document.selection.createRange(),o=document.body.createTextRange();o.moveToElementText(e[0]);r=a.getBookmark();for(i=0;o.compareEndPoints("StartToStart",a)<0&&0!==a.moveStart("character",-1);i++)if("\n"==n.charAt(i))i++;e.val(n.substr(0,Math.min(t,i-1))+n.substr(i,Math.min(t,n.length)));if(n.length!=i){var s=e[0].createTextRange();s.collapse(true);s.moveEnd("character",i-1);s.moveStart("character",i-1);s.select()}}}function i(e,t){var n=t.val();e.trigger("input",[n.length,parseInt(t.attr("maxlength"))])}var r=e.extend({initialize:function(e){var a=this;r.superClass.initialize.apply(a,arguments);if("string"==$.type(e))e=$(e);if(window.addEventListener){e.bind("input",function(){if(t)n(e);i(a,e)});if(t)e.bind("keydown cut paste",function(t){switch(t.type){case"keydown":if(46!=t.keyCode&&8!=t.keyCode)return;default:setTimeout(function(){n(e);i(a,e)},0)}})}else e.bind("propertychange",function(){n(e);i(a,e)})}});return r});define("tui/html5formcore",["tui/event","tui/limitTextarea","tui/placeholder"],function(e,t,n){var i=$.browser.msie&&"9.0"==$.browser.version,r={url:/^\s*[a-zA-z]+:\/\/.*$/,email:/^\s*\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*\s*$/,number:/^\s*-?\.*\d+\s*$/,date:/^\s*\d{2,4}-\d{1,2}-\d{1,2}\s*$/,time:/^\s*\d{1,2}:\d{1,2}(:\d{1,2}(\.\d{1,3})?)?\s*$/,color:/^\s*#?[a-z\d]{3,6}\s*$/},a=document.createElement("input"),o="autofocus"in a,s="form"in a,l=":input:not(:button, :submit, :radio, :checkbox, :reset)",u=e.extend({initialize:function(e,r,a){var s=this;u.superClass.initialize.apply(s,arguments);if("string"==$.type(e))e=$(e);s.form2=e;s.type2=a=a||u.VALID_BLUR;s.list2=[];s.ph2=[];if("function"!=$.type(r)){a=r;r=void 0}if(!e[0]||"FORM"!=e[0].nodeName)return;if(!o)e.find(":input").each(function(){if(null!=this.getAttribute("autofocus")){var e=$(this);e.focus()}});if(!n.NATIVE)e.find("input[placeholder]").each(function(){var e=$(this),t=new n(e);s.list2.push(this);s.ph2.push(t);t.bind("placeholder",function(e,t){s.trigger("placeholder",[e,t])})});s.focusout2=function(){e.attr("novalidate")||s.valid($(this))};if(a==u.VALID_BLUR)e.delegate(l,"focusout",s.focusout2);var c=[];s.focusin2=function(){var e=$(this);if("TEXTAREA"==this.nodeName&&c.indexOf(this)==-1){new t(e);c.push(this)}s.trigger("focus",[e])};e.delegate(l,"focusin",s.focusin2);s.input2=function(){s.trigger("input",[$(this)])};s.keydown_cut_paste2=function(e){var t=$(this);switch(e.type){case"keydown":if(46!=e.keyCode&&8!=e.keyCode)return;default:setTimeout(function(){s.trigger("input",[t])},0)}};if(window.addEventListener){e.delegate(l,"input",s.input2);if(i)e.delegate("textarea","keydown cut paste",s.keydown_cut_paste2)}else e.delegate(l,"keydown contextmenu",s.input2);e.delegate("input:text[name]","keypress",function(t){if(13==t.keyCode){t.preventDefault();e.submit()}});s.click2=function(t){t.preventDefault();e.submit()};e.delegate("input:submit","click",s.click2);s.submit2=function(t){var n=e.attr("novalidate")||s.validAll();if(n){if(r)return r.call(this,t)}else t.preventDefault()};e.bind("submit",s.submit2)},valid:function(e){var t=this.form2,n=e.val(),i=(e[0].getAttribute("type")||"text").toLowerCase(),a=e.attr("pattern"),o=null!=e[0].getAttribute("required"),s=this.list2.indexOf(e[0]);if(o&&(""==n||s!=-1&&this.ph2[s].state())&&!this.ignore(e)){this.trigger("required",[e]);return false}if(n&&n.length&&"INPUT"==e[0].nodeName&&!this.ignore(e)&&r[i]&&!r[i].test(n)){this.trigger(i,[e]);return false}if(n&&n.length&&"number"==i&&!this.ignore(e)){var l=parseFloat(e.attr("max")),u=parseFloat(e.attr("min")),c=parseFloat(n);if(!isNaN(l)&&c>l){this.trigger("max",[e,l]);return false}if(!isNaN(u)&&c<u){this.trigger("min",[e,u]);return false}}if(a&&a.length&&"text"==i&&n&&!this.ignore(e)){if(s!=-1&&this.ph2[s].state())return true;a=new RegExp(a);if(!a.test(n)){this.trigger("pattern",[e]);return false}}return true},validAll:function(){var e=this,t=true,n=e.form2.find(l);n.each(function(i){t=t&&e.valid(n.eq(i))});return t},ignore:function(e){if("string"==$.type(e))e=$(e);return e.prop("disabled")||null!=e[0].getAttribute("novalidate")},type:function(){return this.type2},placeholder:function(e,t){e=$(e);var n=this.list2.indexOf(e[0]);if(n!=-1)return this.ph2[n];console.error("placeholder not found: "+e[0])},cancel:function(){this.form2.undelegate(l,"focusout",this.focusout2);this.form2.undelegate(l,"focusin",this.focusin2);this.form2.undelegate(l,"input",this.input2);if(i)this.form2.undelegate("textarea","keydown cut paste",this.keydown_cut_paste2);this.form2.undelegate(l,"keydown contextmenu",this.input2);this.form2.undelegate("input:submit","click",this.click2);this.form2.unbind("submit",this.submit2);this.ph2.forEach(function(e){e.cancel()})}});u.VALID_BLUR=1;u.VALID_SUBMIT=2;u.SELECTOR=l;return u});define("tui/template",[],function(e,t){t.ns=function(e,t,n){var i,r=n||window,a=e.split(".").reverse();while((i=a.pop())&&a.length>0){if("undefined"===typeof r[i])r[i]={};else if("object"!==typeof r[i])return false;r=r[i]}if("undefined"!==typeof t)r[i]=t;return r[i]};t.format=function(e,t){return e.replace(/<%\=(\w+)%>/g,function(e,n){return null!=t[n]?t[n]:""})};t.escapeHTML=function(e){e=e||"";var t={"<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","{":"&#123;","}":"&#125;","@":"&#64;"};return e.replace(/[<>'"\{\}@]/g,function(e){return t[e]})};t.substr=function(e,t,n){if(!e||"string"!==typeof e)return"";var i=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return n?n.call(i,i):e.length>i.length?i+"...":i};t.strsize=function(e){return e.replace(/([^\x00-\xff]|[A-Z])/g,"$1 ").length};var n=this.document;t.tplSettings={_cache:{},evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};t.tplHelpers={mix:$.extend,escapeHTML:t.escapeHTML,substr:t.substr,include:i,_has:function(e){return function(n){return t.ns(n,void 0,e)}}};function i(e,r,a){var o,s=t.tplSettings,l=a?"#"+a:"";if(!/[\t\r\n% ]/.test(e)){o=s._cache[e+l];if(!o){var u=n.getElementById(e);if(u)o=s._cache[e+l]=i(u.innerHTML,false,a)}}else{var c="var __p=[];"+(a?"":"with(obj){")+"var mix=api.mix,escapeHTML=api.escapeHTML,substr=api.substr,include=api.include,has=api._has("+(a||"obj")+");"+"__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(s.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(s.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');"+(a?"":"}")+"return __p.join('');";try{o=new Function(a||"obj","api",c)}catch(d){console.log("Could not create a template function: \n"+c)}}return!o?"":r?o(r,t.tplHelpers):o}t.convertTpl=i;t.reloadTpl=function(e){delete t.tplSettings._cache[e]}});define("tui/html5form",["tui/template","tui/html5formcore","tui/placeholder"],function(e,t,n){var i='<div class="g_tip"><h3><%=msg%></h3><% if(info && info.length) { %><p><%=info%></p><% } %><span class="arrow"></span></div>',r={url:"url格式不合法",email:"email格式不合法",number:"请输入一个数字",max:"值必须小于或等于",min:"值必须大于或等于",date:"日期格式不合法",time:"时间格式不合法",color:"颜色格式不合法",required:"请填写此项",pattern:"不符合要求格式"},a=$("body"),o=$(window),s=t.extend({initialize:function(){var e=this;s.superClass.initialize.apply(e,arguments);e.phs3=[],e.msg3=[],e.list3=[],e.action3=[];e.bind("required",function(t){e.tip(t,r["required"])});e.bind("url",function(t){e.tip(t,r["url"])});e.bind("email",function(t){e.tip(t,r["email"])});e.bind("number",function(t){e.tip(t,r["number"])});e.bind("max",function(t,n){e.tip(t,r["max"]+n)});e.bind("min",function(t,n){e.tip(t,r["min"]+n)});e.bind("date",function(t){e.tip(t,r["date"])});e.bind("time",function(t){e.tip(t,r["time"])});e.bind("color",function(t){e.tip(t,r["color"])});e.bind("required",function(t){e.tip(t,r["required"])});e.bind("pattern",function(t){e.tip(t,r["pattern"])});e.bind("placeholder",function(e,t){e=$(e);if(t)e.addClass("g_placeholder");else e.removeClass("g_placeholder")});e.bind("input",function(t){e.clear(t)});if(!n.NATIVE){var t=e.form2.find("input[placeholder]");t.each(function(t,n){var i=e.placeholder(n),r=i.state();if(r)$(n).addClass("g_placeholder")})}},tip:function(t,n){console&&console.warn&&console.warn(t);var r=this;r.clearAll();r.list3.push(t);r.phs3.push(t[0]);t.addClass("g_valid");var s=$(e.convertTpl(i,{msg:n,info:t.attr("title")||""}));s.css({left:t.offset().left,top:t.offset().top+t.outerHeight()+7});s.click(function(){t.focus()});r.msg3.push(s);a.append(s);var l=s.offset().top+s.outerHeight()-o.scrollTop()-o.height();if(l>0)o.scrollTop(o.scrollTop()+l);var u=4,c;r.action3.push(c=setInterval(function(){s.css("left",s.offset().left+u);if(u<0)++u;if(0==u){clearInterval(c);return}u*=-1},50));if(o.scrollTop()>t.offset().top)o.scrollTop(t.offset().top);else if(o.scrollTop()+o.height()<t.offset().top+t.height())o.scrollTop(t.offset().top+t.height()-o.height());
if(r.ct)clearTimeout(r.ct);r.ct=setTimeout(function(){r.clearAll()},5e3);return this},clear:function(e){if("string"==$.type(e))e=$(e);var t=this.phs3.indexOf(e[0]);if(t!=-1){this.phs3.splice(t,1);this.list3.splice(t,1);this.msg3[t].remove();this.msg3.splice(t,1);clearInterval(this.action3[t]);this.action3.splice(t,1);e.removeClass("g_valid")}return this},clearAll:function(){this.phs3=[];while(this.msg3.length)this.msg3.pop().remove();while(this.list3.length)this.list3.pop().removeClass("g_valid");while(this.action3.length){var e=this.action3.pop();clearInterval(e)}return this}});return s});define("tui/cookie",[],function(){return function(e,t,n,i){if("string"==typeof e){i=n;n=t;t=e;e=window}if(void 0!==n){i=i||{};var r,a="";if(i.expires){if(i.expires.constructor==Date)r=i.expires;else{r=new Date;r.setTime(r.getTime()+1e3*60*60*24*i.expires)}a="; expires="+r.toGMTString()}var o=i.path?"; path="+i.path:"";var s=i.domain?"; domain="+i.domain:"";var l=i.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(n),a,o,s,l].join("")}else{n=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)"));return n?decodeURIComponent(n[1]):null}}});define("m/login",["tui/cookie","tui/event","tui/art","tui/dialog","tui/html5form","tui/countdown","m/model"],function(e,t,n,i,r,a,o,s,l){var u="jishachengta.com.cn";var c=window.base_domain||"";var d=new t;var f='欢迎访问集沙成塔 <a href="<%=domain%>/usercenter/" class="uname" target="_blank"><%=u_name%></a><a href="#" class="jsLogout">退出</a>\n|<a href="<%=domain%>/usercenter/order" target="_blank">支持的项目</a>';var p=n.compile(f);var v='<h3>登录</h3>\n<a href="#" class="close" data-role="close">X</a>\n<form id="loginForm">\n<div class="l"><input class="tel" type="text" pattern= "^1[3|5|8|7|4|6]\\d{9}" placeholder="手机号" required /><i class="icon"></i></div>\n<div class="l"><input class="pwd" type="password" pattern="^\\w{6,}" placeholder="密码" required /><i class="icon icon2"></i></div>\n<p class="p"><a href="<%=url%>" target="_blank">忘记密码了？</a></p>\n<div class="btn">\n<a class="submit" href="#">登 录</a>\n</div>\n</form>\n<div class="foot">\n没有账户？<a href="#" target="_blank" class="b goreg">注册账户</a>\n</div>';var h=n.compile(v);var m='<h3>注册新账户</h3>\n<a href="#" class="close" data-role="close">X</a>\n<div class="l l2">已有账户？<a href="#" class="login">登录</a></div>\n<form id="regForm">\n<div class="l"><input class="tel" name="tel" type="text" pattern= "^1[3|5|8|7|4|6]\\d{9}" placeholder="请输入您的手机号(必填)" required /><i class="icon icon3"></i></div>\n<div class="l"><input class="username" name="username" type="text" placeholder="请输入您的真实姓名(必填)" required /><i class="icon"></i></div>\n<div class="l"><input class="pwd" name="pwd" type="password" placeholder="请设置密码，不少于6位(必填)" required /><i class="icon icon2"></i></div>\n<div class="l"><input class="ckpwd" name="checkpwd" type="password" placeholder="请再次输入密码(必填)" /><i class="icon icon2"></i></div>\n<div class="l"><input class="code" name="code" type="text" placeholder="请输入验证码(必填)" required /><a href="#" class="send">获取手机验证码</a></i></div>\n<div class="l"><input class="recmobile" name="recmobile" type="text" placeholder="请输入推荐人的手机号(选填)" /><i class="icon icon3"></i></div>\n<div class="btn">\n<a class="submit" href="#">提交注册</a>\n</div>\n</form>\n<div class="foot">\n注册即代表同意<a href="<%=domain%>/about/service" target="_blank" class="b">集沙成塔服务条款</a>\n</div>';var g=n.compile(m);var b={domain:u,path:"/"};var w=/^1[3|5|8|7|4|6]\d{9}/;var y=e("u_id");var x=e("u_name");var _=e("u_pic");d.isLogin=function(){y=e("u_id");x=e("u_name");_=e("u_pic");return y&&"0"!=y};function k(){}function T(t){t=t||{};_=t.u_pic;y=t.u_id;x=t.u_name;e("u_id",y,b);e("u_name",x,b);e("u_pic",_,b)}function M(){e("u_id",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"});e("u_name",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"});e("u_pic",0,{domain:u,path:"/",expires:"Thu, 01 Jan 1970 00:00:01 GMT"})}function C(e,t){e.domain=c;$("#gUser").html(p(e));t&&T(e)}d.autoLogin=function(e,t){if(d.isLogin())C({u_id:y,u_name:x,u_pic:_})};d.userInfo=function(){return d.isLogin()?{u_id:y,u_name:x,u_pic:_}:false};function S(e,t){var n=new i({className:"login_dialog reg_dialog",content:g({domain:c})});var a=n.dom.content;var s=a.find("form");var l=s.find(".tel");var u=s.find(".pwd");var f=s.find(".ckpwd");var p=s.find(".username");var v=s.find(".code");var h=s.find(".recmobile");var m=new r(s,r.VALID_BLUR);var b={};var y;a.on("click",".submit",function(e){e.preventDefault();b.mobile=l.val().trim();if(!w.test(b.mobile)){m.tip(l,"请填写正确的手机号码");return}if(!y){m.tip(l,"该手机号码已注册");return}b.pwd=u.val().trim();if(!/^\w{6,}$/.test(b.pwd)){m.tip(u,"请输入至少六位数的密码");return}b.ckpwd=f.val().trim();if(b.ckpwd!==b.pwd){m.tip(f,"两次输入的密码不一致");return}b.realname=p.val().trim();if(!b.realname.length){m.tip(p,"请输入真实的姓名");return}b.code=v.val().trim();if(!b.code.length){m.tip(v,"请输入手机验证码");return}b.recmobile=h.val().trim();if(b.recmobile.length&&!w.test(b.recmobile)){m.tip(h,"请填写正确的手机号码");return}b.act=2;o.postData(b,function(e){i.alert("注册成功，请重新登录。");t&&t();n.close();m.clearAll()},k,true)}).on("click",".login",function(e){e.preventDefault();n.close();m.clearAll();d.needLogin()}).on("blur",".ckpwd",function(){var e=$(this).val().trim();var t=u.val().trim();if(e&&e!==t)m.tip(f,"两次输入的密码不一致")}).on("blur",".tel",function(e){e.preventDefault();var t=$(this).val().trim();if(!w.test(t)){m.tip(l,"请填写正确的手机号码");return}if(y)return;o.getData({act:6,mobile:t},function(e){if(1==e.data){m.tip(l,"该手机号码已注册");y=false}else y=true})}).on("change",".tel",function(e){y=false}).on("click",".send",function(e){e.preventDefault();var t=$(this);if(!t.hasClass("sending"))L(t,l,m)})}function L(e,t,n){var i=t.val().trim();if(!w.test(i)){n.tip(t,"请填写正确的手机号码");return}e.html("<i>60</i>秒后可重新获取").addClass("sending");var r=e.find("i");a(r,60,function(){e.html("获取手机验证码").removeClass("sending")});o.getData({act:5,mobile:i},function(e){if(e.data)console.log(e.msg)})}d.needLogin=function(e,t){if("function"===typeof e){t=e;e={}}else e=e||{};if(d.isLogin()){t&&t();return}if(e.reg){S(e,t);return}var n=new i({className:"login_dialog",content:h({url:c+"/findpass/step1"})});var a=n.dom.content;var s=a.find("form");var l=s.find(".tel");var u=s.find(".pwd");var f=new r(s,r.VALID_BLUR);var p={};a.on("click",".submit",function(e){e.preventDefault();p.username=l.val().trim();if(!w.test(p.username)){f.tip(l,"请填写正确的手机号码");return}p.password=u.val().trim();if(!p.password.length){f.tip(u,"请输入密码");return}p.act=3;o.postData(p,function(e){C({u_id:e.data.userId,u_name:e.data.username||e.data.realname,u_pic:"http://u1.tdimg.com/u/U-01.gif"},true);t&&t();n.close();f.clearAll()},k,true)}).on("click",".goreg",function(i){i.preventDefault();n.close();f.clearAll();S(e,t)})};d.exit=function(e){i.confirm("您确认要退出嘛？",function(){var t=/usercenter/.test(location.pathname);o.getData({act:8},function(){$("#gUser").html('欢迎访问集沙成塔<a class="login" href="#" id="gLogin" title="请登录">请登录</a>|<a class="reg" href="#" id="gReg" title="免费注册">免费注册</a>');M();if(t)location.reload();if(e)e()},k,true)})};return d});define("module/numstep",["tui/html5form","tui/event"],function(e,t,n,i){var r=t.extend({initialize:function(t){var n=$(t.node).find('[data-role="numstep"]');var i=parseInt(t.step||1,10);var a=this;var o=n.find("input");var s=+o.val();var l=new e(n.closest("form"));r.superClass.initialize.apply(a,arguments);if(n[0])n.on("click",'[data-role="minus"]',function(e){e.preventDefault();if(s-i>0){s-=i;a.trigger("num:step",[s]);o.val(s)}}).on("click",'[data-role="plus"]',function(e){e.preventDefault();s+=i;a.trigger("num:step",[s]);o.val(s)}).on("keyup",o,function(){s=parseInt(o.val(),10);if(!s||"number"!==typeof s||s<1){l&&l.tip(o,"请输入正整数!");return}a.trigger("num:step",[s]);o.val(s)})}});return r});define("tui/util/num",[],function(e,t){function n(e,t){var n="",i=e<0,r=String(Math.abs(e));if(r.length<t)n=new Array(t-r.length+1).join("0");return(i?"-":"")+n+r}function i(e,t){t=t.length;e=e||0;return 1==t?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function r(e,t){t=t||",";return String(e).replace(/(\d)(?=(\d{3})+($|\.))/g,"$1"+t)}function a(e){e=parseInt(e);var t;if(e>=1e8)t=(e/1e8).toFixed(2)+"亿";else if(e>=1e4){var n=e/1e4;var i=parseInt(n).toString();var a=i.length;if(a<4&&n!=i)i=n.toFixed(1==a?2:4-a);t=r(i)+"万"}else t=r(e);return t}function o(e){e=parseInt(e);var t=-1;do{e/=1024;t++}while(e>1024);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}t.pad=n;t.format=i;t.split=r;t.field=a;t.bytes=o});define("m/buyform",["tui/util/num","module/numstep","m/login"],function(e,t,n){return function(){var i=$("#buyForm");var r=i.find('input[name="total"]');var a=i.find(".total");var o=i.find(".price").attr("data-price");var s=new t({node:i,step:1});s.bind("num:step",function(t){r.val(t*o);a.text(e.split(t*o))});i.on("submit",function(e){if(!n.isLogin()){e.preventDefault();n.needLogin()}})}});define("module/pie",[],function(e,t){function n(){var e=document.body||document.createElement("div");var t=["webkit","Moz","ms","O",""];var n;t.forEach(function(t){if("undefined"!==typeof e.style[t+"Animation"])n=t?"-"+t.toLowerCase()+"-":""});$(".progress-pie").each(function(e,t){var i=$(this);var r=i.find(".percent").text()||"0";r=r>100?100:r;if(n){r=3.6*r;if(r<=180)i.find(".right").css(n+"transform","rotate("+r+"deg)");else{i.find(".right").css(n+"transform","rotate(180deg)");i.find(".left").css(n+"transform","rotate("+(r-180)+"deg)")}}else i.css({background:"none"}).html('<div class="pie pie_'+r.slice(0,100==r?2:1)+'">'+r+"%</div>")})}t.init=function(){n()}});define("m/nav",["tui/art","m/login"],function(e,t,n,i){t.autoLogin();function r(){$(".mini-nav").on("mouseenter",".btn-qrcode",function(){$(this).find(".qrcode").css({height:"auto"})}).on("mouseleave",".sns",function(){$(this).find(".qrcode").css({height:"0"})})}function a(){$("#gUser").on("click","#gLogin, #gReg",function(e){e.preventDefault();var n=$(this).attr("id");t.needLogin({reg:"gReg"==n})}).on("click",".jsLogout",function(e){e.preventDefault();t.exit()})}i.init=function(){a();r()}});require(["m/nav","module/pie","m/buyform","m/share","m/favor"],function(e,t,n,i,r){e.init();t.init();n();i();r.init("#buyForm")})}(window.jQuery);;